function submitAjax(t){$.ajax({url:$(t).attr("action"),type:$(t).attr("method")}).done(function(t){t=JSON.parse(t),t.success?($(".ajax-success").removeClass("hidden"),$(".ajax-success .message").text(t.message)):($(".ajax-error").removeClass("hidden"),$(".ajax-error .message").text(t.message))})}function highlightCorrect(){var t=$(".correct-answer").toArray();t.forEach(function(t){var e=$(t)[0].value,i=$(t).next().children("li")[e-1];$(i).addClass("correct")})}function pad2(t){return(10>t?"0":"")+t}function getTotalTime(t,e,i,o){var n=60*(e-t)+(o-i);return console.log(n),n}function validateCC(t){if(""==t.find("#cc").val())return!0;var e="Are you sure you want to CC the following: \r\n",i=t.find("#cc").val().replace(" ","").split(",");return i.forEach(function(t){var i=$("#userlist").find('[data-initials="'+t+'"]');e+=" "+i.data("name")+"("+t+")\r\n"}),window.confirm(e)}+function(t){"use strict";var e='[data-dismiss="alert"]',i=function(i){t(i).on("click",e,this.close)};i.prototype.close=function(e){function i(){s.trigger("closed.bs.alert").remove()}var o=t(this),n=o.attr("data-target");n||(n=o.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,""));var s=t(n);e&&e.preventDefault(),s.length||(s=o.hasClass("alert")?o:o.parent()),s.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one(t.support.transition.end,i).emulateTransitionEnd(150):i())};var o=t.fn.alert;t.fn.alert=function(e){return this.each(function(){var o=t(this),n=o.data("bs.alert");n||o.data("bs.alert",n=new i(this)),"string"==typeof e&&n[e].call(o)})},t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=o,this},t(document).on("click.bs.alert.data-api",e,i.prototype.close)}(jQuery),+function(t){"use strict";var e=function(i,o){this.$element=t(i),this.options=t.extend({},e.DEFAULTS,o),this.isLoading=!1};e.DEFAULTS={loadingText:"loading..."},e.prototype.setState=function(e){var i="disabled",o=this.$element,n=o.is("input")?"val":"html",s=o.data();e+="Text",s.resetText||o.data("resetText",o[n]()),o[n](s[e]||this.options[e]),setTimeout(t.proxy(function(){"loadingText"==e?(this.isLoading=!0,o.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,o.removeClass(i).removeAttr(i))},this),0)},e.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}t&&this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=function(i){return this.each(function(){var o=t(this),n=o.data("bs.button"),s="object"==typeof i&&i;n||o.data("bs.button",n=new e(this,s)),"toggle"==i?n.toggle():i&&n.setState(i)})},t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.bs.button.data-api","[data-toggle^=button]",function(e){var i=t(e.target);i.hasClass("btn")||(i=i.closest(".btn")),i.button("toggle"),e.preventDefault()})}(jQuery),+function(t){"use strict";var e=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",t.proxy(this.pause,this)).on("mouseleave",t.proxy(this.cycle,this))};e.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},e.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},e.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},e.prototype.to=function(e){var i=this,o=this.getActiveIndex();return e>this.$items.length-1||0>e?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(e)}):o==e?this.pause().cycle():this.slide(e>o?"next":"prev",t(this.$items[e]))},e.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},e.prototype.next=function(){return this.sliding?void 0:this.slide("next")},e.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},e.prototype.slide=function(e,i){var o=this.$element.find(".item.active"),n=i||o[e](),s=this.interval,a="next"==e?"left":"right",r="next"==e?"first":"last",l=this;if(!n.length){if(!this.options.wrap)return;n=this.$element.find(".item")[r]()}if(n.hasClass("active"))return this.sliding=!1;var d=t.Event("slide.bs.carousel",{relatedTarget:n[0],direction:a});return this.$element.trigger(d),d.isDefaultPrevented()?void 0:(this.sliding=!0,s&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var e=t(l.$indicators.children()[l.getActiveIndex()]);e&&e.addClass("active")})),t.support.transition&&this.$element.hasClass("slide")?(n.addClass(e),n[0].offsetWidth,o.addClass(a),n.addClass(a),o.one(t.support.transition.end,function(){n.removeClass([e,a].join(" ")).addClass("active"),o.removeClass(["active",a].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(1e3*o.css("transition-duration").slice(0,-1))):(o.removeClass("active"),n.addClass("active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")),s&&this.cycle(),this)};var i=t.fn.carousel;t.fn.carousel=function(i){return this.each(function(){var o=t(this),n=o.data("bs.carousel"),s=t.extend({},e.DEFAULTS,o.data(),"object"==typeof i&&i),a="string"==typeof i?i:s.slide;n||o.data("bs.carousel",n=new e(this,s)),"number"==typeof i?n.to(i):a?n[a]():s.interval&&n.pause().cycle()})},t.fn.carousel.Constructor=e,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this},t(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(e){var i,o=t(this),n=t(o.attr("data-target")||(i=o.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),s=t.extend({},n.data(),o.data()),a=o.attr("data-slide-to");a&&(s.interval=!1),n.carousel(s),(a=o.attr("data-slide-to"))&&n.data("bs.carousel").to(a),e.preventDefault()}),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var e=t(this);e.carousel(e.data())})})}(jQuery),+function(t){"use strict";function e(e){t(o).remove(),t(n).each(function(){var o=i(t(this)),n={relatedTarget:this};o.hasClass("open")&&(o.trigger(e=t.Event("hide.bs.dropdown",n)),e.isDefaultPrevented()||o.removeClass("open").trigger("hidden.bs.dropdown",n))})}function i(e){var i=e.attr("data-target");i||(i=e.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var o=i&&t(i);return o&&o.length?o:e.parent()}var o=".dropdown-backdrop",n="[data-toggle=dropdown]",s=function(e){t(e).on("click.bs.dropdown",this.toggle)};s.prototype.toggle=function(o){var n=t(this);if(!n.is(".disabled, :disabled")){var s=i(n),a=s.hasClass("open");if(e(),!a){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e);var r={relatedTarget:this};if(s.trigger(o=t.Event("show.bs.dropdown",r)),o.isDefaultPrevented())return;s.toggleClass("open").trigger("shown.bs.dropdown",r),n.focus()}return!1}},s.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var o=t(this);if(e.preventDefault(),e.stopPropagation(),!o.is(".disabled, :disabled")){var s=i(o),a=s.hasClass("open");if(!a||a&&27==e.keyCode)return 27==e.which&&s.find(n).focus(),o.click();var r=" li:not(.divider):visible a",l=s.find("[role=menu]"+r+", [role=listbox]"+r);if(l.length){var d=l.index(l.filter(":focus"));38==e.keyCode&&d>0&&d--,40==e.keyCode&&d<l.length-1&&d++,~d||(d=0),l.eq(d).focus()}}}};var a=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var i=t(this),o=i.data("bs.dropdown");o||i.data("bs.dropdown",o=new s(this)),"string"==typeof e&&o[e].call(i)})},t.fn.dropdown.Constructor=s,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",n,s.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu], [role=listbox]",s.prototype.keydown)}(jQuery),+function(t){"use strict";var e=function(e,i){this.options=i,this.$element=t(e),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};e.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},e.prototype.toggle=function(t){return this[this.isShown?"hide":"show"](t)},e.prototype.show=function(e){var i=this,o=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.backdrop(function(){var o=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(document.body),i.$element.show().scrollTop(0),o&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var n=t.Event("shown.bs.modal",{relatedTarget:e});o?i.$element.find(".modal-dialog").one(t.support.transition.end,function(){i.$element.focus().trigger(n)}).emulateTransitionEnd(300):i.$element.focus().trigger(n)}))},e.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one(t.support.transition.end,t.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},e.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.focus()},this))},e.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},e.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden.bs.modal")})},e.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},e.prototype.backdrop=function(e){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&i;if(this.$backdrop=t('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;o?this.$backdrop.one(t.support.transition.end,e).emulateTransitionEnd(150):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,e).emulateTransitionEnd(150):e()):e&&e()};var i=t.fn.modal;t.fn.modal=function(i,o){return this.each(function(){var n=t(this),s=n.data("bs.modal"),a=t.extend({},e.DEFAULTS,n.data(),"object"==typeof i&&i);s||n.data("bs.modal",s=new e(this,a)),"string"==typeof i?s[i](o):a.show&&s.show(o)})},t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var i=t(this),o=i.attr("href"),n=t(i.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),s=n.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(o)&&o},n.data(),i.data());i.is("a")&&e.preventDefault(),n.modal(s,this).one("hide",function(){i.is(":visible")&&i.focus()})}),t(document).on("show.bs.modal",".modal",function(){t(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){t(document.body).removeClass("modal-open")})}(jQuery),+function(t){"use strict";var e=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};e.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.prototype.init=function(e,i,o){this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(o);for(var n=this.options.trigger.split(" "),s=n.length;s--;){var a=n[s];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},e.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,o){i[t]!=o&&(e[t]=o)}),e},e.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show()},e.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},e.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(e),e.isDefaultPrevented())return;var i=this,o=this.tip();this.setContent(),this.options.animation&&o.addClass("fade");var n="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,a=s.test(n);a&&(n=n.replace(s,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(n),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element);var r=this.getPosition(),l=o[0].offsetWidth,d=o[0].offsetHeight;if(a){var c=this.$element.parent(),h=n,u=document.documentElement.scrollTop||document.body.scrollTop,p="body"==this.options.container?window.innerWidth:c.outerWidth(),f="body"==this.options.container?window.innerHeight:c.outerHeight(),m="body"==this.options.container?0:c.offset().left;n="bottom"==n&&r.top+r.height+d-u>f?"top":"top"==n&&r.top-u-d<0?"bottom":"right"==n&&r.right+l>p?"left":"left"==n&&r.left-l<m?"right":n,o.removeClass(h).addClass(n)}var g=this.getCalculatedOffset(n,r,l,d);this.applyPlacement(g,n),this.hoverState=null;var v=function(){i.$element.trigger("shown.bs."+i.type)};t.support.transition&&this.$tip.hasClass("fade")?o.one(t.support.transition.end,v).emulateTransitionEnd(150):v()}},e.prototype.applyPlacement=function(e,i){var o,n=this.tip(),s=n[0].offsetWidth,a=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),l=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(l)&&(l=0),e.top=e.top+r,e.left=e.left+l,t.offset.setOffset(n[0],t.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),n.addClass("in");var d=n[0].offsetWidth,c=n[0].offsetHeight;if("top"==i&&c!=a&&(o=!0,e.top=e.top+a-c),/bottom|top/.test(i)){var h=0;e.left<0&&(h=-2*e.left,e.left=0,n.offset(e),d=n[0].offsetWidth,c=n[0].offsetHeight),this.replaceArrow(h-s+d,d,"left")}else this.replaceArrow(c-a,c,"top");o&&n.offset(e)},e.prototype.replaceArrow=function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},e.prototype.hide=function(){function e(){"in"!=i.hoverState&&o.detach(),i.$element.trigger("hidden.bs."+i.type)}var i=this,o=this.tip(),n=t.Event("hide.bs."+this.type);return this.$element.trigger(n),n.isDefaultPrevented()?void 0:(o.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?o.one(t.support.transition.end,e).emulateTransitionEnd(150):e(),this.hoverState=null,this)},e.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},e.prototype.hasContent=function(){return this.getTitle()},e.prototype.getPosition=function(){var e=this.$element[0];return t.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},e.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},e.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},e.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},e.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},e.prototype.enable=function(){this.enabled=!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.toggleEnabled=function(){this.enabled=!this.enabled},e.prototype.toggle=function(e){var i=e?t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;i.tip().hasClass("in")?i.leave(i):i.enter(i)},e.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=t.fn.tooltip;t.fn.tooltip=function(i){return this.each(function(){var o=t(this),n=o.data("bs.tooltip"),s="object"==typeof i&&i;(n||"destroy"!=i)&&(n||o.data("bs.tooltip",n=new e(this,s)),"string"==typeof i&&n[i]())})},t.fn.tooltip.Constructor=e,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),+function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),e.prototype.constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content")[this.options.html?"string"==typeof i?"html":"append":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},e.prototype.tip=function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip};var i=t.fn.popover;t.fn.popover=function(i){return this.each(function(){var o=t(this),n=o.data("bs.popover"),s="object"==typeof i&&i;(n||"destroy"!=i)&&(n||o.data("bs.popover",n=new e(this,s)),"string"==typeof i&&n[i]())})},t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),+function(t){"use strict";var e=function(e){this.element=t(e)};e.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),o=e.data("target");if(o||(o=e.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var n=i.find(".active:last a")[0],s=t.Event("show.bs.tab",{relatedTarget:n});if(e.trigger(s),!s.isDefaultPrevented()){var a=t(o);this.activate(e.parent("li"),i),this.activate(a,a.parent(),function(){e.trigger({type:"shown.bs.tab",relatedTarget:n})})}}},e.prototype.activate=function(e,i,o){function n(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),o&&o()}var s=i.find("> .active"),a=o&&t.support.transition&&s.hasClass("fade");a?s.one(t.support.transition.end,n).emulateTransitionEnd(150):n(),s.removeClass("in")};var i=t.fn.tab;t.fn.tab=function(i){return this.each(function(){var o=t(this),n=o.data("bs.tab");n||o.data("bs.tab",n=new e(this)),"string"==typeof i&&n[i]()})},t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=i,this},t(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),t(this).tab("show")})}(jQuery),+function(t){"use strict";var e=function(i,o){this.options=t.extend({},e.DEFAULTS,o),this.$window=t(window).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(i),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$window.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=t(document).height(),o=this.$window.scrollTop(),n=this.$element.offset(),s=this.options.offset,a=s.top,r=s.bottom;"top"==this.affixed&&(n.top+=o),"object"!=typeof s&&(r=a=s),"function"==typeof a&&(a=s.top(this.$element)),"function"==typeof r&&(r=s.bottom(this.$element));var l=null!=this.unpin&&o+this.unpin<=n.top?!1:null!=r&&n.top+this.$element.height()>=i-r?"bottom":null!=a&&a>=o?"top":!1;if(this.affixed!==l){this.unpin&&this.$element.css("top","");var d="affix"+(l?"-"+l:""),c=t.Event(d+".bs.affix");this.$element.trigger(c),c.isDefaultPrevented()||(this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(d).trigger(t.Event(d.replace("affix","affixed"))),"bottom"==l&&this.$element.offset({top:i-r-this.$element.height()}))}}};var i=t.fn.affix;t.fn.affix=function(i){return this.each(function(){var o=t(this),n=o.data("bs.affix"),s="object"==typeof i&&i;n||o.data("bs.affix",n=new e(this,s)),"string"==typeof i&&n[i]()})},t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),i=e.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),e.affix(i)})})}(jQuery),+function(t){"use strict";var e=function(i,o){this.$element=t(i),this.options=t.extend({},e.DEFAULTS,o),this.transitioning=null,this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};e.DEFAULTS={toggle:!0},e.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},e.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e=t.Event("show.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.$parent&&this.$parent.find("> .panel > .in");if(i&&i.length){var o=i.data("bs.collapse");if(o&&o.transitioning)return;i.collapse("hide"),o||i.data("bs.collapse",null)}var n=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[n](0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[n]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return s.call(this);var a=t.camelCase(["scroll",n].join("-"));this.$element.one(t.support.transition.end,t.proxy(s,this)).emulateTransitionEnd(350)[n](this.$element[0][a])}}},e.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return t.support.transition?void this.$element[i](0).one(t.support.transition.end,t.proxy(o,this)).emulateTransitionEnd(350):o.call(this)}}},e.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var i=t.fn.collapse;t.fn.collapse=function(i){return this.each(function(){var o=t(this),n=o.data("bs.collapse"),s=t.extend({},e.DEFAULTS,o.data(),"object"==typeof i&&i);!n&&s.toggle&&"show"==i&&(i=!i),n||o.data("bs.collapse",n=new e(this,s)),"string"==typeof i&&n[i]()})},t.fn.collapse.Constructor=e,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this},t(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(e){var i,o=t(this),n=o.attr("data-target")||e.preventDefault()||(i=o.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),s=t(n),a=s.data("bs.collapse"),r=a?"toggle":o.data(),l=o.attr("data-parent"),d=l&&t(l);a&&a.transitioning||(d&&d.find('[data-toggle=collapse][data-parent="'+l+'"]').not(o).addClass("collapsed"),o[s.hasClass("in")?"addClass":"removeClass"]("collapsed")),s.collapse(r)})}(jQuery),+function(t){"use strict";function e(i,o){var n,s=t.proxy(this.process,this);this.$element=t(t(i).is("body")?window:i),this.$body=t("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",s),this.options=t.extend({},e.DEFAULTS,o),this.selector=(this.options.target||(n=t(i).attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=t([]),this.targets=t([]),this.activeTarget=null,this.refresh(),this.process()}e.DEFAULTS={offset:10},e.prototype.refresh=function(){var e=this.$element[0]==window?"offset":"position";this.offsets=t([]),this.targets=t([]);{var i=this;this.$body.find(this.selector).map(function(){var o=t(this),n=o.data("target")||o.attr("href"),s=/^#./.test(n)&&t(n);return s&&s.length&&s.is(":visible")&&[[s[e]().top+(!t.isWindow(i.$scrollElement.get(0))&&i.$scrollElement.scrollTop()),n]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})}},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,o=i-this.$scrollElement.height(),n=this.offsets,s=this.targets,a=this.activeTarget;if(e>=o)return a!=(t=s.last()[0])&&this.activate(t);if(a&&e<=n[0])return a!=(t=s[0])&&this.activate(t);for(t=n.length;t--;)a!=s[t]&&e>=n[t]&&(!n[t+1]||e<=n[t+1])&&this.activate(s[t])},e.prototype.activate=function(e){this.activeTarget=e,t(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',o=t(i).parents("li").addClass("active");o.parent(".dropdown-menu").length&&(o=o.closest("li.dropdown").addClass("active")),o.trigger("activate.bs.scrollspy")};var i=t.fn.scrollspy;t.fn.scrollspy=function(i){return this.each(function(){var o=t(this),n=o.data("bs.scrollspy"),s="object"==typeof i&&i;n||o.data("bs.scrollspy",n=new e(this,s)),"string"==typeof i&&n[i]()})},t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);e.scrollspy(e.data())})})}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,o=this;t(this).one(t.support.transition.end,function(){i=!0});var n=function(){i||t(o).trigger(t.support.transition.end)};return setTimeout(n,e),this},t(function(){t.support.transition=e()})}(jQuery),function(t){"use strict";var e={i18n:{ru:{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayOfWeek:["Вск","Пн","Вт","Ср","Чт","Пт","Сб"]},en:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},de:{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dayOfWeek:["So","Mo","Di","Mi","Do","Fr","Sa"]},nl:{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dayOfWeek:["zo","ma","di","wo","do","vr","za"]},tr:{months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dayOfWeek:["Paz","Pts","Sal","Çar","Per","Cum","Cts"]},fr:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dayOfWeek:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},es:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dayOfWeek:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]},th:{months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],dayOfWeek:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},pl:{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],dayOfWeek:["nd","pn","wt","śr","cz","pt","sb"]},pt:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},ch:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},se:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeek:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},kr:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeek:["일","월","화","수","목","금","토"]},it:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dayOfWeek:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]}},value:"",lang:"en",format:"Y/m/d H:i",formatTime:"H:i",formatDate:"Y/m/d",step:60,closeOnDateSelect:0,closeOnWithoutClick:!0,timepicker:!0,datepicker:!0,minDate:!1,maxDate:!1,minTime:!1,maxTime:!1,allowTimes:[],opened:!1,initTime:!0,inline:!1,onSelectDate:function(){},onSelectTime:function(){},onChangeMonth:function(){},onChangeDateTime:function(){},onShow:function(){},onClose:function(){},onGenerate:function(){},withoutCopyright:!0,inverseButton:!1,hours12:!1,next:"xdsoft_next",prev:"xdsoft_prev",dayOfWeekStart:0,timeHeightInTimePicker:25,timepickerScrollbar:!0,todayButton:!0,defaultSelect:!0,scrollMonth:!0,scrollTime:!0,scrollInput:!0,mask:!1,validateOnBlur:!0,allowBlank:!1,yearStart:1950,yearEnd:2050,style:"",id:"",roundTime:"round",className:"",weekends:[],yearOffset:0};
Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){for(var i=e||0,o=this.length;o>i;i++)if(this[i]===t)return i;return-1}),t.fn.xdsoftScroller=function(e){return this.each(function(){var i=t(this);if(!t(this).hasClass("xdsoft_scroller_box")){var o=function(t){var e={x:0,y:0};if("touchstart"==t.type||"touchmove"==t.type||"touchend"==t.type||"touchcancel"==t.type){var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];e.x=i.pageX,e.y=i.pageY}else("mousedown"==t.type||"mouseup"==t.type||"mousemove"==t.type||"mouseover"==t.type||"mouseout"==t.type||"mouseenter"==t.type||"mouseleave"==t.type)&&(e.x=t.pageX,e.y=t.pageY);return e},n=0,s=i.children().eq(0),a=i[0].clientHeight,r=s[0].offsetHeight,l=t('<div class="xdsoft_scrollbar"></div>'),d=t('<div class="xdsoft_scroller"></div>'),c=100,h=!1;l.append(d),i.addClass("xdsoft_scroller_box").append(l),d.on("mousedown.xdsoft_scroller",function(o){a||i.trigger("resize_scroll.xdsoft_scroller",[e]);var s=o.pageY,r=parseInt(d.css("margin-top")),h=l[0].offsetHeight;t(document.body).addClass("xdsoft_noselect"),t([document.body,window]).on("mouseup.xdsoft_scroller",function u(){t([document.body,window]).off("mouseup.xdsoft_scroller",u).off("mousemove.xdsoft_scroller",n).removeClass("xdsoft_noselect")}),t(document.body).on("mousemove.xdsoft_scroller",n=function(t){var e=t.pageY-s+r;0>e&&(e=0),e+d[0].offsetHeight>h&&(e=h-d[0].offsetHeight),i.trigger("scroll_element.xdsoft_scroller",[c?e/c:0])})}),i.on("scroll_element.xdsoft_scroller",function(t,e){a||i.trigger("resize_scroll.xdsoft_scroller",[e,!0]),e=e>1?1:0>e||isNaN(e)?0:e,d.css("margin-top",c*e),s.css("marginTop",-parseInt((r-a)*e))}).on("resize_scroll.xdsoft_scroller",function(t,e,o){a=i[0].clientHeight,r=s[0].offsetHeight;var n=a/r,h=n*l[0].offsetHeight;n>1?d.hide():(d.show(),d.css("height",parseInt(h>10?h:10)),c=l[0].offsetHeight-d[0].offsetHeight,o!==!0&&i.trigger("scroll_element.xdsoft_scroller",[e?e:Math.abs(parseInt(s.css("marginTop")))/(r-a)]))}),i.mousewheel&&i.mousewheel(function(t,e){var o=Math.abs(parseInt(s.css("marginTop")));return i.trigger("scroll_element.xdsoft_scroller",[(o-20*e)/(r-a)]),t.stopPropagation(),!1}),i.on("touchstart",function(t){h=o(t)}),i.on("touchmove",function(t){if(h){var e=o(t),n=Math.abs(parseInt(s.css("marginTop")));i.trigger("scroll_element.xdsoft_scroller",[(n-(e.y-h.y))/(r-a)]),t.stopPropagation(),t.preventDefault()}}),i.on("touchend touchcancel",function(){h=!1})}i.trigger("resize_scroll.xdsoft_scroller",[e])})},t.fn.datetimepicker=function(i){var o=48,n=57,s=96,a=105,r=17,l=46,d=13,c=27,h=8,u=37,p=38,f=39,m=40,g=9,v=116,b=65,y=67,x=86,_=90,w=89,$=!1,k=t.isPlainObject(i)||!i?t.extend(!0,{},e,i):t.extend({},e),C=function(e){var i=t("<div "+(k.id?'id="'+k.id+'"':"")+" "+(k.style?'style="'+k.style+'"':"")+' class="xdsoft_datetimepicker xdsoft_noselect '+k.className+'"></div>'),C=t('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),T=t('<div class="xdsoft_datepicker active"></div>'),D=t('<div class="xdsoft_mounthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span></div><div class="xdsoft_label xdsoft_year"><span></span></div><button type="button" class="xdsoft_next"></button></div>'),S=t('<div class="xdsoft_calendar"></div>'),A=t('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),N=A.find(".xdsoft_time_box").eq(0),M=t('<div class="xdsoft_time_variant"></div>'),R=t('<div class="xdsoft_scrollbar"></div>'),E=(t('<div class="xdsoft_scroller"></div>'),t('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>')),L=t('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>');D.find(".xdsoft_month span").after(E),D.find(".xdsoft_year span").after(L),D.find(".xdsoft_month,.xdsoft_year").on("mousedown.xdsoft",function(e){D.find(".xdsoft_select").hide();var i=t(this).find(".xdsoft_select").eq(0),o=0,n=0;I.currentTime&&(o=I.currentTime[t(this).hasClass("xdsoft_month")?"getMonth":"getFullYear"]()),i.show();for(var s=i.find("div.xdsoft_option"),a=0;a<s.length&&s.eq(a).data("value")!=o;a++)n+=s[0].offsetHeight;return i.xdsoftScroller(n/(i.children()[0].offsetHeight-i[0].clientHeight)),e.stopPropagation(),!1}),D.find(".xdsoft_select").xdsoftScroller().on("mousedown.xdsoft",function(t){t.stopPropagation(),t.preventDefault()}).on("mousedown.xdsoft",".xdsoft_option",function(){I&&I.currentTime&&I.currentTime[t(this).parent().parent().hasClass("xdsoft_monthselect")?"setMonth":"setFullYear"](t(this).data("value")),t(this).parent().parent().hide(),i.trigger("xchange.xdsoft"),k.onChangeMonth&&k.onChangeMonth.call&&k.onChangeMonth.call(i,I.currentTime,i.data("input"))}),i.setOptions=function(C){k=t.extend(!0,{},k,C),!k.open&&!k.opened||k.inline||e.trigger("open.xdsoft"),k.inline&&(i.addClass("xdsoft_inline"),e.after(i).hide(),i.trigger("afterOpen.xdsoft")),k.inverseButton&&(k.next="xdsoft_prev",k.prev="xdsoft_next"),k.datepicker?T.addClass("active"):T.removeClass("active"),k.timepicker?A.addClass("active"):A.removeClass("active"),k.value&&(e&&e.val&&e.val(k.value),I.setCurrentTime(k.value)),k.dayOfWeekStart=isNaN(k.dayOfWeekStart)||parseInt(k.dayOfWeekStart)<0||parseInt(k.dayOfWeekStart)>6?0:parseInt(k.dayOfWeekStart),k.timepickerScrollbar||R.hide();var S,N=[];if(k.minDate&&(N=/^-(.*)$/.exec(k.minDate))&&(N=Date.parseDate(N[1],k.formatDate))&&(S=N.getTime()+-1*N.getTimezoneOffset()*6e4,k.minDate=new Date(I.now().getTime()-S).dateFormat(k.formatDate)),k.maxDate&&(N=/^\+(.*)$/.exec(k.maxDate))&&(N=Date.parseDate(N[1],k.formatDate))&&(S=N.getTime()+-1*N.getTimezoneOffset()*6e4,k.maxDate=new Date(I.now().getTime()+S).dateFormat(k.formatDate)),D.find(".xdsoft_today_button").css("visibility",k.todayButton?"visible":"hidden"),k.mask){var M=function(t){try{if(document.selection&&document.selection.createRange){var e=document.selection.createRange();return e.getBookmark().charCodeAt(2)-2}if(t.setSelectionRange)return t.selectionStart}catch(i){return 0}},E=function(t,e){var t="string"==typeof t||t instanceof String?document.getElementById(t):t;if(!t)return!1;if(t.createTextRange){var i=t.createTextRange();return i.collapse(!0),i.moveEnd(e),i.moveStart(e),i.select(),!0}return t.setSelectionRange?(t.setSelectionRange(e,e),!0):!1},L=function(t,e){var i=t.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g,"\\$1").replace(/_/g,"{digit+}").replace(/([0-9]{1})/g,"{digit$1}").replace(/\{digit([0-9]{1})\}/g,"[0-$1_]{1}").replace(/\{digit[\+]\}/g,"[0-9_]{1}");return RegExp(i).test(e)};switch(e.off("keydown.xdsoft"),!0){case k.mask===!0:k.mask=k.format.replace(/Y/g,"9999").replace(/F/g,"9999").replace(/m/g,"19").replace(/d/g,"39").replace(/H/g,"29").replace(/i/g,"59").replace(/s/g,"59");case"string"==t.type(k.mask):L(k.mask,e.val())||e.val(k.mask.replace(/[0-9]/g,"_")),e.on("keydown.xdsoft",function(i){var C=this.value,T=i.which;switch(!0){case T>=o&&n>=T||T>=s&&a>=T||T==h||T==l:var D=M(this),S=T!=h&&T!=l?String.fromCharCode(T>=s&&a>=T?T-o:T):"_";for(T!=h&&T!=l||!D||(D--,S="_");/[^0-9_]/.test(k.mask.substr(D,1))&&D<k.mask.length&&D>0;)D+=T==h||T==l?-1:1;if(C=C.substr(0,D)+S+C.substr(D+1),""==t.trim(C))C=k.mask.replace(/[0-9]/g,"_");else if(D==k.mask.length)break;for(D+=T==h||T==l?0:1;/[^0-9_]/.test(k.mask.substr(D,1))&&D<k.mask.length&&D>0;)D+=T==h||T==l?-1:1;L(k.mask,C)?(this.value=C,E(this,D)):""==t.trim(C)?this.value=k.mask.replace(/[0-9]/g,"_"):e.trigger("error_input.xdsoft");break;case!!~[b,y,x,_,w].indexOf(T)&&$:case!!~[c,p,m,u,f,v,r,g,d].indexOf(T):return!0}return i.preventDefault(),!1})}}k.validateOnBlur&&e.off("blur.xdsoft").on("blur.xdsoft",function(){k.allowBlank&&!t.trim(t(this).val()).length?(t(this).val(null),i.data("xdsoft_datetime").empty()):Date.parseDate(t(this).val(),k.format)?i.data("xdsoft_datetime").setCurrentTime(t(this).val()):(t(this).val(I.now().dateFormat(k.format)),i.data("xdsoft_datetime").setCurrentTime(t(this).val())),i.trigger("changedatetime.xdsoft")}),k.dayOfWeekStartPrev=0==k.dayOfWeekStart?6:k.dayOfWeekStart-1,i.trigger("xchange.xdsoft")},i.data("options",k).on("mousedown.xdsoft",function(t){return t.stopPropagation(),t.preventDefault(),L.hide(),E.hide(),!1});var O=A.find(".xdsoft_time_box");O.append(M),O.xdsoftScroller(),i.on("afterOpen.xdsoft",function(){O.xdsoftScroller()}),i.append(T).append(A),k.withoutCopyright!==!0&&i.append(C),T.append(D).append(S),t("body").append(i);var I=new function(){var t=this;t.now=function(){var t=new Date;return k.yearOffset&&t.setFullYear(t.getFullYear()+k.yearOffset),t},t.currentTime=this.now(),t.isValidDate=function(t){return"[object Date]"!==Object.prototype.toString.call(t)?!1:!isNaN(t.getTime())},t.setCurrentTime=function(e){t.currentTime="string"==typeof e?t.strtodatetime(e):t.isValidDate(e)?e:t.now(),i.trigger("xchange.xdsoft")},t.empty=function(){t.currentTime=null},t.getCurrentTime=function(){return t.currentTime},t.nextMonth=function(){var e=t.currentTime.getMonth()+1;return 12==e&&(t.currentTime.setFullYear(t.currentTime.getFullYear()+1),e=0),t.currentTime.setDate(Math.min(Date.daysInMonth[e],t.currentTime.getDate())),t.currentTime.setMonth(e),k.onChangeMonth&&k.onChangeMonth.call&&k.onChangeMonth.call(i,I.currentTime,i.data("input")),i.trigger("xchange.xdsoft"),e},t.prevMonth=function(){var e=t.currentTime.getMonth()-1;return-1==e&&(t.currentTime.setFullYear(t.currentTime.getFullYear()-1),e=11),t.currentTime.setDate(Math.min(Date.daysInMonth[e],t.currentTime.getDate())),t.currentTime.setMonth(e),k.onChangeMonth&&k.onChangeMonth.call&&k.onChangeMonth.call(i,I.currentTime,i.data("input")),i.trigger("xchange.xdsoft"),e},t.strtodatetime=function(e){var i=e?Date.parseDate(e,k.format):t.now();return t.isValidDate(i)||(i=t.now()),i},t.strtodate=function(e){var i=e?Date.parseDate(e,k.formatDate):t.now();return t.isValidDate(i)||(i=t.now()),i},t.strtotime=function(e){var i=e?Date.parseDate(e,k.formatTime):t.now();return t.isValidDate(i)||(i=t.now()),i},t.str=function(){return t.currentTime.dateFormat(k.format)}};D.find(".xdsoft_today_button").on("mousedown.xdsoft",function(){i.data("changed",!0),I.setCurrentTime(0),i.trigger("afterOpen.xdsoft")}).on("dblclick.xdsoft",function(){e.val(I.str()),i.trigger("close.xdsoft")}),D.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var e=t(this),i=0,o=!1;!function n(t){I.currentTime.getMonth();e.hasClass(k.next)?I.nextMonth():e.hasClass(k.prev)&&I.prevMonth(),!o&&(i=setTimeout(n,t?t:100))}(500),t([document.body,window]).on("mouseup.xdsoft",function s(){clearTimeout(i),o=!0,t([document.body,window]).off("mouseup.xdsoft",s)})}),A.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var e=t(this),i=0,o=!1,n=110;!function s(t){var a=N[0].clientHeight,r=M[0].offsetHeight,l=Math.abs(parseInt(M.css("marginTop")));e.hasClass(k.next)&&r-a-k.timeHeightInTimePicker>=l?M.css("marginTop","-"+(l+k.timeHeightInTimePicker)+"px"):e.hasClass(k.prev)&&l-k.timeHeightInTimePicker>=0&&M.css("marginTop","-"+(l-k.timeHeightInTimePicker)+"px"),N.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(M.css("marginTop"))/(r-a))]),n=n>10?10:n-10,!o&&(i=setTimeout(s,t?t:n))}(500),t([document.body,window]).on("mouseup.xdsoft",function a(){clearTimeout(i),o=!0,t([document.body,window]).off("mouseup.xdsoft",a)})}),i.on("xchange.xdsoft",function(e){for(var o="",n=new Date(I.currentTime.getFullYear(),I.currentTime.getMonth(),1,12,0,0),s=0,a=I.now();n.getDay()!=k.dayOfWeekStart;)n.setDate(n.getDate()-1);o+="<table><thead><tr>";for(var r=0;7>r;r++)o+="<th>"+k.i18n[k.lang].dayOfWeek[r+k.dayOfWeekStart>6?0:r+k.dayOfWeekStart]+"</th>";o+="</tr></thead>",o+="<tbody><tr>";var l=!1,d=!1;k.maxDate!==!1&&(l=I.strtodate(k.maxDate),l=new Date(l.getFullYear(),l.getMonth(),l.getDate(),23,59,59,999)),k.minDate!==!1&&(d=I.strtodate(k.minDate),d=new Date(d.getFullYear(),d.getMonth(),d.getDate()));for(var c,h,u,p=[];s<I.currentTime.getDaysInMonth()||n.getDay()!=k.dayOfWeekStart||I.currentTime.getMonth()==n.getMonth();)p=[],s++,c=n.getDate(),h=n.getFullYear(),u=n.getMonth(),p.push("xdsoft_date"),(l!==!1&&n>l||d!==!1&&d>n)&&p.push("xdsoft_disabled"),I.currentTime.getMonth()!=u&&p.push("xdsoft_other_month"),(k.defaultSelect||i.data("changed"))&&I.currentTime.dateFormat("d.m.Y")==n.dateFormat("d.m.Y")&&p.push("xdsoft_current"),a.dateFormat("d.m.Y")==n.dateFormat("d.m.Y")&&p.push("xdsoft_today"),(0==n.getDay()||6==n.getDay()||~k.weekends.indexOf(n.dateFormat("d.m.Y")))&&p.push("xdsoft_weekend"),o+='<td data-date="'+c+'" data-month="'+u+'" data-year="'+h+'" class="xdsoft_date xdsoft_day_of_week'+n.getDay()+" "+p.join(" ")+'"><div>'+c+"</div></td>",n.getDay()==k.dayOfWeekStartPrev&&(o+="</tr>"),n.setDate(c+1);o+="</tbody></table>",S.html(o),D.find(".xdsoft_label span").eq(0).text(k.i18n[k.lang].months[I.currentTime.getMonth()]),D.find(".xdsoft_label span").eq(1).text(I.currentTime.getFullYear());var f="",m="",u="",g=function(t,e){var o=I.now();o.setHours(t),t=parseInt(o.getHours()),o.setMinutes(e),e=parseInt(o.getMinutes()),p=[],(k.maxTime!==!1&&I.strtotime(k.maxTime).getTime()<o.getTime()||k.minTime!==!1&&I.strtotime(k.minTime).getTime()>o.getTime())&&p.push("xdsoft_disabled"),(k.initTime||k.defaultSelect||i.data("changed"))&&parseInt(I.currentTime.getHours())==parseInt(t)&&(k.step>59||Math[k.roundTime](I.currentTime.getMinutes()/k.step)*k.step==parseInt(e))&&(k.defaultSelect||i.data("changed")?p.push("xdsoft_current"):k.initTime&&p.push("xdsoft_init_time")),parseInt(a.getHours())==parseInt(t)&&parseInt(a.getMinutes())==parseInt(e)&&p.push("xdsoft_today"),f+='<div class="xdsoft_time '+p.join(" ")+'" data-hour="'+t+'" data-minute="'+e+'">'+o.dateFormat(k.formatTime)+"</div>"};if(k.allowTimes&&t.isArray(k.allowTimes)&&k.allowTimes.length)for(var s=0;s<k.allowTimes.length;s++)m=I.strtotime(k.allowTimes[s]).getHours(),u=I.strtotime(k.allowTimes[s]).getMinutes(),g(m,u);else for(var s=0,r=0;s<(k.hours12?12:24);s++)for(r=0;60>r;r+=k.step)m=(10>s?"0":"")+s,u=(10>r?"0":"")+r,g(m,u);M.html(f);var v="",s=0;for(s=parseInt(k.yearStart,10)+k.yearOffset;s<=parseInt(k.yearEnd,10)+k.yearOffset;s++)v+='<div class="xdsoft_option '+(I.currentTime.getFullYear()==s?"xdsoft_current":"")+'" data-value="'+s+'">'+s+"</div>";for(L.children().eq(0).html(v),s=0,v="";11>=s;s++)v+='<div class="xdsoft_option '+(I.currentTime.getMonth()==s?"xdsoft_current":"")+'" data-value="'+s+'">'+k.i18n[k.lang].months[s]+"</div>";E.children().eq(0).html(v),t(this).trigger("generate.xdsoft"),e.stopPropagation()}).on("afterOpen.xdsoft",function(){if(k.timepicker){var t;if(M.find(".xdsoft_current").length?t=".xdsoft_current":M.find(".xdsoft_init_time").length&&(t=".xdsoft_init_time"),t){var e=N[0].clientHeight,i=M[0].offsetHeight,o=M.find(t).index()*k.timeHeightInTimePicker+1;o>i-e&&(o=i-e),M.css("marginTop","-"+parseInt(o)+"px"),N.trigger("scroll_element.xdsoft_scroller",[parseInt(o)/(i-e)])}}});var j=0;S.on("click.xdsoft","td",function(){j++;var o=t(this),n=I.currentTime;return o.hasClass("xdsoft_disabled")?!1:(n.setFullYear(o.data("year")),n.setMonth(o.data("month")),n.setDate(o.data("date")),i.trigger("select.xdsoft",[n]),e.val(I.str()),(j>1||k.closeOnDateSelect===!0||0===k.closeOnDateSelect&&!k.timepicker)&&!k.inline&&i.trigger("close.xdsoft"),k.onSelectDate&&k.onSelectDate.call&&k.onSelectDate.call(i,I.currentTime,i.data("input")),i.data("changed",!0),i.trigger("xchange.xdsoft"),i.trigger("changedatetime.xdsoft"),void setTimeout(function(){j=0},200))}),M.on("click.xdsoft","div",function(){var e=t(this),o=I.currentTime;return e.hasClass("xdsoft_disabled")?!1:(o.setHours(e.data("hour")),o.setMinutes(e.data("minute")),i.trigger("select.xdsoft",[o]),i.data("input").val(I.str()),!k.inline&&i.trigger("close.xdsoft"),k.onSelectTime&&k.onSelectTime.call&&k.onSelectTime.call(i,I.currentTime,i.data("input")),i.data("changed",!0),i.trigger("xchange.xdsoft"),void i.trigger("changedatetime.xdsoft"))}),i.mousewheel&&T.mousewheel(function(t,e){return k.scrollMonth?(0>e?I.nextMonth():I.prevMonth(),!1):!0}),i.mousewheel&&N.unmousewheel().mousewheel(function(t,e){if(!k.scrollTime)return!0;var i=N[0].clientHeight,o=M[0].offsetHeight,n=Math.abs(parseInt(M.css("marginTop"))),s=!0;return 0>e&&o-i-k.timeHeightInTimePicker>=n?(M.css("marginTop","-"+(n+k.timeHeightInTimePicker)+"px"),s=!1):e>0&&n-k.timeHeightInTimePicker>=0&&(M.css("marginTop","-"+(n-k.timeHeightInTimePicker)+"px"),s=!1),N.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(M.css("marginTop"))/(o-i))]),t.stopPropagation(),s}),i.on("changedatetime.xdsoft",function(){if(k.onChangeDateTime&&k.onChangeDateTime.call){var t=i.data("input");k.onChangeDateTime.call(i,I.currentTime,t),t.trigger("change")}}).on("generate.xdsoft",function(){k.onGenerate&&k.onGenerate.call&&k.onGenerate.call(i,I.currentTime,i.data("input"))});var F=0;e.mousewheel&&e.mousewheel(function(t,o,n,s){return k.scrollInput?!k.datepicker&&k.timepicker?(F=M.find(".xdsoft_current").length?M.find(".xdsoft_current").eq(0).index():0,F+o>=0&&F+o<M.children().length&&(F+=o),M.children().eq(F).length&&M.children().eq(F).trigger("mousedown"),!1):k.datepicker&&!k.timepicker?(T.trigger(t,[o,n,s]),e.val&&e.val(I.str()),i.trigger("changedatetime.xdsoft"),!1):void 0:!0});var P=function(){var e=i.data("input").offset(),o=e.top+i.data("input")[0].offsetHeight-1,n=e.left;o+i[0].offsetHeight>t(window).height()+t(window).scrollTop()&&(o=e.top-i[0].offsetHeight+1),0>o&&(o=0),n+i[0].offsetWidth>t(window).width()&&(n=e.left-i[0].offsetWidth+i.data("input")[0].offsetWidth),i.css({left:n,top:o})};i.on("open.xdsoft",function(){var e=!0;k.onShow&&k.onShow.call&&(e=k.onShow.call(i,I.currentTime,i.data("input"))),e!==!1&&(i.show(),i.trigger("afterOpen.xdsoft"),P(),t(window).off("resize.xdsoft",P).on("resize.xdsoft",P),k.closeOnWithoutClick&&t([document.body,window]).on("mousedown.xdsoft",function o(){i.trigger("close.xdsoft"),t([document.body,window]).off("mousedown.xdsoft",o)}))}).on("close.xdsoft",function(t){var e=!0;k.onClose&&k.onClose.call&&(e=k.onClose.call(i,I.currentTime,i.data("input"))),e===!1||k.opened||k.inline||i.hide(),t.stopPropagation()}).data("input",e);var H=0;i.data("xdsoft_datetime",I),i.setOptions(k);var B=k.value?k.value:e&&e.val&&e.val()?e.val():"";B&&I.isValidDate(B=Date.parseDate(B,k.format))?i.data("changed",!0):B="",I.setCurrentTime(B?B:0),i.trigger("afterOpen.xdsoft"),e.data("xdsoft_datetimepicker",i).on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function(){e.is(":disabled")||e.is(":hidden")||!e.is(":visible")||(clearTimeout(H),H=setTimeout(function(){e.is(":disabled")||e.is(":hidden")||!e.is(":visible")||(I.setCurrentTime(e&&e.val&&e.val()?e.val():0),i.trigger("open.xdsoft"))},100))}).on("keydown.xdsoft",function(e){var o=(this.value,e.which);switch(!0){case!!~[d].indexOf(o):var n=t("input:visible,textarea:visible");return i.trigger("close.xdsoft"),n.eq(n.index(this)+1).focus(),!1;case!!~[g].indexOf(o):return i.trigger("close.xdsoft"),!0}})},T=function(e){var i=e.data("xdsoft_datetimepicker");i&&(i.data("xdsoft_datetime",null),i.remove(),e.data("xdsoft_datetimepicker",null).off("open.xdsoft focusin.xdsoft focusout.xdsoft mousedown.xdsoft blur.xdsoft keydown.xdsoft"),t(window).off("resize.xdsoft"),t([window,document.body]).off("mousedown.xdsoft"),e.unmousewheel&&e.unmousewheel())};return t(document).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl",function(t){t.keyCode==r&&($=!0)}).on("keyup.xdsoftctrl",function(t){t.keyCode==r&&($=!1)}),this.each(function(){var e;if(e=t(this).data("xdsoft_datetimepicker")){if("string"===t.type(i))switch(i){case"show":t(this).select().focus(),e.trigger("open.xdsoft");break;case"hide":e.trigger("close.xdsoft");break;case"destroy":T(t(this));break;case"reset":this.value=this.defaultValue,this.value&&e.data("xdsoft_datetime").isValidDate(Date.parseDate(this.value,k.format))||e.data("changed",!1),e.data("xdsoft_datetime").setCurrentTime(this.value)}else e.setOptions(i);return 0}"string"!==t.type(i)&&C(t(this))})}}(jQuery),Date.parseFunctions={count:0},Date.parseRegexes=[],Date.formatFunctions={count:0},Date.prototype.dateFormat=function(t){null==Date.formatFunctions[t]&&Date.createNewFormat(t);var e=Date.formatFunctions[t];return this[e]()},Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;for(var code="Date.prototype."+funcName+" = function() {return ",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,code+="'"+String.escape(ch)+"' + "):code+=Date.getFormatCode(ch):special=!0;eval(code.substring(0,code.length-3)+";}")},Date.getFormatCode=function(t){switch(t){case"d":return"String.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"String.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"String.leftPad(this.getHours(), 2, '0') + ";case"i":return"String.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"String.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+String.escape(t)+"' + "}},Date.parseDate=function(t,e){null==Date.parseFunctions[e]&&Date.createParser(e);var i=Date.parseFunctions[e];return Date[i](t)},Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++,regexNum=Date.parseRegexes.length,currentGroup=1;Date.parseFunctions[format]=funcName;for(var code="Date."+funcName+" = function(input) {\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {",regex="",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,regex+=String.escape(ch)):(obj=Date.formatCodeToRegex(ch,currentGroup),currentGroup+=obj.g,regex+=obj.s,obj.g&&obj.c&&(code+=obj.c)):special=!0;code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}",Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$"),eval(code)},Date.formatCodeToRegex=function(t,e){switch(t){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+e+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:0,c:null,s:"(?:\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+e+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+e+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+e+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+e+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+e+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+e+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+e+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+e+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+e+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+e+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:String.escape(t)}}},Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+String.leftPad(Math.abs(this.getTimezoneOffset())%60,2,"0")},Date.prototype.getDayOfYear=function(){var t=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var e=0;e<this.getMonth();++e)t+=Date.daysInMonth[e];return t+this.getDate()-1},Date.prototype.getWeekOfYear=function(){var t=this.getDayOfYear()+(4-this.getDay()),e=new Date(this.getFullYear(),0,1),i=7-e.getDay()+4;return document.write(i),String.leftPad((t-i)/7+1,2,"0")},Date.prototype.isLeapYear=function(){var t=this.getFullYear();return 0==(3&t)&&(t%100||t%400==0&&t)},Date.prototype.getFirstDayOfMonth=function(){var t=(this.getDay()-(this.getDate()-1))%7;return 0>t?t+7:t},Date.prototype.getLastDayOfMonth=function(){var t=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return 0>t?t+7:t},Date.prototype.getDaysInMonth=function(){return Date.daysInMonth[1]=this.isLeapYear()?29:28,Date.daysInMonth[this.getMonth()]},Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},String.escape=function(t){return t.replace(/('|\\)/g,"\\$1")},String.leftPad=function(t,e,i){var o=new String(t);for(null==i&&(i=" ");o.length<e;)o=i+o;return o},Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.y2kYear=50,Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"},function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var n,s=e||window.event,a=[].slice.call(arguments,1),r=0,l=0,d=0,c=0,h=0;return e=t.event.fix(s),e.type="mousewheel",s.wheelDelta&&(r=s.wheelDelta),s.detail&&(r=-1*s.detail),s.deltaY&&(d=-1*s.deltaY,r=d),s.deltaX&&(l=s.deltaX,r=-1*l),void 0!==s.wheelDeltaY&&(d=s.wheelDeltaY),void 0!==s.wheelDeltaX&&(l=-1*s.wheelDeltaX),c=Math.abs(r),(!i||i>c)&&(i=c),h=Math.max(Math.abs(d),Math.abs(l)),(!o||o>h)&&(o=h),n=r>0?"floor":"ceil",r=Math[n](r/i),l=Math[n](l/o),d=Math[n](d/o),a.unshift(e,r,l,d),(t.event.dispatch||t.event.handle).apply(this,a)}var i,o,n=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(t.event.fixHooks)for(var a=n.length;a;)t.event.fixHooks[n[--a]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=s.length;t;)this.addEventListener(s[--t],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var t=s.length;t;)this.removeEventListener(s[--t],e,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})});var rwindow,rdocument;if("undefined"==typeof RELANG)var RELANG={};var RLANG={html:"HTML",video:"Insert Video",image:"Insert Image",table:"Table",link:"Link",link_insert:"Insert link",unlink:"Unlink",formatting:"Formatting",paragraph:"Paragraph",quote:"Quote",code:"Code",header1:"Header 1",header2:"Header 2",header3:"Header 3",header4:"Header 4",bold:"Bold",italic:"Italic",fontcolor:"Font Color",backcolor:"Back Color",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",cancel:"Cancel",insert:"Insert",save:"Save",_delete:"Delete",insert_table:"Insert Table",insert_row_above:"Add Row Above",insert_row_below:"Add Row Below",insert_column_left:"Add Column Left",insert_column_right:"Add Column Right",delete_column:"Delete Column",delete_row:"Delete Row",delete_table:"Delete Table",rows:"Rows",columns:"Columns",add_head:"Add Head",delete_head:"Delete Head",title:"Title",image_position:"Position",none:"None",left:"Left",right:"Right",image_web_link:"Image Web Link",text:"Text",mailto:"Email",web:"URL",video_html_code:"Video Embed Code",file:"Insert File",upload:"Upload",download:"Download",choose:"Choose",or_choose:"Or choose",drop_file_here:"Drop file here",align_left:"Align text to the left",align_center:"Center text",align_right:"Align text to the right",align_justify:"Justify text",horizontalrule:"Insert Horizontal Rule",deleted:"Deleted",anchor:"Anchor",link_new_tab:"Open link in new tab",underline:"Underline",alignment:"Alignment"};!function(t){jQuery.fn.redactor=function(i){return this.each(function(){var o=t(this),n=o.data("redactor");n||o.data("redactor",n=new e(this,i))})};var e=function(e,i){this.$el=t(e),"undefined"!=typeof i&&"undefined"!=typeof i.lang&&"en"!==i.lang&&"undefined"!=typeof RELANG[i.lang]&&(RLANG=RELANG[i.lang]),this.opts=t.extend({iframe:!1,css:!1,lang:"en",direction:"ltr",callback:!1,keyupCallback:!1,keydownCallback:!1,execCommandCallback:!1,plugins:!1,cleanup:!0,focus:!1,tabindex:!1,autoresize:!0,minHeight:!1,fixed:!1,fixedTop:0,fixedBox:!1,source:!0,shortcuts:!0,mobile:!0,air:!1,wym:!1,convertLinks:!0,convertDivs:!0,protocol:"http://",autosave:!1,autosaveCallback:!1,interval:60,imageGetJson:!1,imageUpload:!1,imageUploadCallback:!1,imageUploadErrorCallback:!1,fileUpload:!1,fileUploadCallback:!1,fileUploadErrorCallback:!1,uploadCrossDomain:!1,uploadFields:!1,observeImages:!0,overlay:!0,allowedTags:["form","input","button","select","option","datalist","output","textarea","fieldset","legend","section","header","hgroup","aside","footer","article","details","nav","progress","time","canvas","code","span","div","label","a","br","p","b","i","del","strike","u","img","video","source","track","audio","iframe","object","embed","param","blockquote","mark","cite","small","ul","ol","li","hr","dl","dt","dd","sup","sub","big","pre","code","figure","figcaption","strong","em","table","tr","td","th","tbody","thead","tfoot","h1","h2","h3","h4","h5","h6"],toolbarExternal:!1,buttonsCustom:{},buttonsAdd:[],buttons:["html","|","formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","image","video","file","table","link","|","fontcolor","backcolor","|","alignment","|","horizontalrule"],airButtons:["formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","fontcolor","backcolor"],formattingTags:["p","blockquote","pre","h1","h2","h3","h4"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline"},colors:["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"],emptyHtml:"<p><br /></p>",buffer:!1,visual:!0,modal_file:String()+'<div id="redactor_modal_content"><form id="redactorUploadFileForm" method="post" action="" enctype="multipart/form-data"><label>Name (optional)</label><input type="text" id="redactor_filename" class="redactor_input" /><div style="margin-top: 7px;"><input type="file" id="redactor_file" name="file" /></div></form><br></div>',modal_image_edit:String()+'<div id="redactor_modal_content"><label>'+RLANG.title+'</label><input id="redactor_file_alt" class="redactor_input" /><label>'+RLANG.link+'</label><input id="redactor_file_link" class="redactor_input" /><label>'+RLANG.image_position+'</label><select id="redactor_form_image_align"><option value="none">'+RLANG.none+'</option><option value="left">'+RLANG.left+'</option><option value="right">'+RLANG.right+'</option></select></div><div id="redactor_modal_footer"><a href="javascript:void(null);" id="redactor_image_delete_btn" class="redactor_modal_btn">'+RLANG._delete+'</a>&nbsp;&nbsp;&nbsp;<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" name="save" class="redactor_modal_btn" id="redactorSaveBtn" value="'+RLANG.save+'" /></div>',modal_image:String()+'<div id="redactor_modal_content"><div id="redactor_tabs"><a href="javascript:void(null);" class="redactor_tabs_act">'+RLANG.upload+'</a><a href="javascript:void(null);">'+RLANG.choose+'</a><a href="javascript:void(null);">'+RLANG.link+'</a></div><form id="redactorInsertImageForm" method="post" action="" enctype="multipart/form-data"><div id="redactor_tab1" class="redactor_tab"><input type="file" id="redactor_file" name="file" /></div><div id="redactor_tab2" class="redactor_tab" style="display: none;"><div id="redactor_image_box"></div></div></form><div id="redactor_tab3" class="redactor_tab" style="display: none;"><label>'+RLANG.image_web_link+'</label><input type="text" name="redactor_file_link" id="redactor_file_link" class="redactor_input"  /></div></div><div id="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_upload_btn" value="'+RLANG.insert+'" /></div>',modal_link:String()+'<div id="redactor_modal_content"><form id="redactorInsertLinkForm" method="post" action=""><div id="redactor_tabs"><a href="javascript:void(null);" class="redactor_tabs_act">URL</a><a href="javascript:void(null);">Email</a><a href="javascript:void(null);">'+RLANG.anchor+'</a></div><input type="hidden" id="redactor_tab_selected" value="1" /><div class="redactor_tab" id="redactor_tab1"><label>URL</label><input type="text" id="redactor_link_url" class="redactor_input"  /><label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_url_text" /><label><input type="checkbox" id="redactor_link_blank"> '+RLANG.link_new_tab+'</label></div><div class="redactor_tab" id="redactor_tab2" style="display: none;"><label>Email</label><input type="text" id="redactor_link_mailto" class="redactor_input" /><label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_mailto_text" /></div><div class="redactor_tab" id="redactor_tab3" style="display: none;"><label>'+RLANG.anchor+'</label><input type="text" class="redactor_input" id="redactor_link_anchor"  /><label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_anchor_text" /></div></form></div><div id="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" class="redactor_modal_btn" id="redactor_insert_link_btn" value="'+RLANG.insert+'" /></div>',modal_table:String()+'<div id="redactor_modal_content"><label>'+RLANG.rows+'</label><input type="text" size="5" value="2" id="redactor_table_rows" /><label>'+RLANG.columns+'</label><input type="text" size="5" value="3" id="redactor_table_columns" /></div><div id="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_insert_table_btn" value="'+RLANG.insert+'" /></div>',modal_video:String()+'<div id="redactor_modal_content"><form id="redactorInsertVideoForm"><label>'+RLANG.video_html_code+'</label><textarea id="redactor_insert_video_area" style="width: 99%; height: 160px;"></textarea></form></div><div id="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" class="redactor_modal_btn" id="redactor_insert_video_btn" value="'+RLANG.insert+'" /></div>',toolbar:{html:{title:RLANG.html,func:"toggle"},formatting:{title:RLANG.formatting,func:"show",dropdown:{p:{title:RLANG.paragraph,exec:"formatblock"},blockquote:{title:RLANG.quote,exec:"formatblock",className:"redactor_format_blockquote"},pre:{title:RLANG.code,exec:"formatblock",className:"redactor_format_pre"},h1:{title:RLANG.header1,exec:"formatblock",className:"redactor_format_h1"},h2:{title:RLANG.header2,exec:"formatblock",className:"redactor_format_h2"},h3:{title:RLANG.header3,exec:"formatblock",className:"redactor_format_h3"},h4:{title:RLANG.header4,exec:"formatblock",className:"redactor_format_h4"}}},bold:{title:RLANG.bold,exec:"bold"},italic:{title:RLANG.italic,exec:"italic"},deleted:{title:RLANG.deleted,exec:"strikethrough"},underline:{title:RLANG.underline,exec:"underline"},unorderedlist:{title:"&bull; "+RLANG.unorderedlist,exec:"insertunorderedlist"},orderedlist:{title:"1. "+RLANG.orderedlist,exec:"insertorderedlist"},outdent:{title:"< "+RLANG.outdent,exec:"outdent"},indent:{title:"> "+RLANG.indent,exec:"indent"},image:{title:RLANG.image,func:"showImage"},video:{title:RLANG.video,func:"showVideo"},file:{title:RLANG.file,func:"showFile"},table:{title:RLANG.table,func:"show",dropdown:{insert_table:{title:RLANG.insert_table,func:"showTable"},separator_drop1:{name:"separator"},insert_row_above:{title:RLANG.insert_row_above,func:"insertRowAbove"},insert_row_below:{title:RLANG.insert_row_below,func:"insertRowBelow"},insert_column_left:{title:RLANG.insert_column_left,func:"insertColumnLeft"},insert_column_right:{title:RLANG.insert_column_right,func:"insertColumnRight"},separator_drop2:{name:"separator"},add_head:{title:RLANG.add_head,func:"addHead"},delete_head:{title:RLANG.delete_head,func:"deleteHead"},separator_drop3:{name:"separator"},delete_column:{title:RLANG.delete_column,func:"deleteColumn"},delete_row:{title:RLANG.delete_row,func:"deleteRow"},delete_table:{title:RLANG.delete_table,func:"deleteTable"}}},link:{title:RLANG.link,func:"show",dropdown:{link:{title:RLANG.link_insert,func:"showLink"},unlink:{title:RLANG.unlink,exec:"unlink"}}},fontcolor:{title:RLANG.fontcolor,func:"show"},backcolor:{title:RLANG.backcolor,func:"show"},alignment:{title:RLANG.alignment,func:"show",dropdown:{alignleft:{title:RLANG.align_left,exec:"JustifyLeft"},aligncenter:{title:RLANG.align_center,exec:"JustifyCenter"},alignright:{title:RLANG.align_right,exec:"JustifyRight"},justify:{title:RLANG.align_justify,exec:"JustifyFull"}}},alignleft:{exec:"JustifyLeft",title:RLANG.align_left},aligncenter:{exec:"JustifyCenter",title:RLANG.align_center},alignright:{exec:"JustifyRight",title:RLANG.align_right},justify:{exec:"JustifyFull",title:RLANG.align_justify},horizontalrule:{exec:"inserthorizontalrule",title:RLANG.horizontalrule}}},i,this.$el.data()),this.dropdowns=[],this.init()
};e.prototype={init:function(){function e(){if(this.enableAir(),this.buildToolbar(),"object"==typeof this.opts.plugins&&t.each(this.opts.plugins,t.proxy(function(e,i){"undefined"!=typeof RedactorPlugins[i]&&(t.extend(this,RedactorPlugins[i]),"undefined"!=typeof RedactorPlugins[i].init&&this.init())},this)),this.opts.activeButtons!==!1&&this.opts.toolbar!==!1){var e=t.proxy(function(){this.observeFormatting()},this);this.$editor.click(e).keyup(e)}var i=!1;if(this.browser("webkit")&&-1===navigator.userAgent.indexOf("Chrome")){var o=this.browser("version").split(".");o[0]<536&&(i=!0)}if(this.isMobile(!0)===!1&&i===!1&&this.$editor.bind("paste",t.proxy(function(){if(this.opts.cleanup===!1)return!0;this.pasteRunning=!0,this.setBuffer(),this.saveScroll=this.opts.autoresize===!0?this.document.body.scrollTop:this.$editor.scrollTop();var e=this.extractContent();setTimeout(t.proxy(function(){var t=this.extractContent();this.$editor.append(e),this.restoreSelection();var i=this.getFragmentHtml(t);this.pasteCleanUp(i),this.pasteRunning=!1},this),1)},this)),this.keyup(),this.keydown(),this.opts.autosave!==!1&&this.autoSave(),setTimeout(t.proxy(function(){this.observeImages(),this.observeTables()},this),1),this.browser("mozilla")){this.$editor.click(t.proxy(function(){this.saveSelection()},this));try{this.document.execCommand("enableObjectResizing",!1,!1),this.document.execCommand("enableInlineTableEditing",!1,!1)}catch(n){}}this.opts.focus&&setTimeout(t.proxy(function(){this.$editor.focus()},this),1),this.opts.fixed&&(this.observeScroll(),t(document).scroll(t.proxy(this.observeScroll,this))),"function"==typeof this.opts.callback&&this.opts.callback(this),this.opts.toolbar!==!1&&this.$toolbar.find("a").attr("tabindex","-1")}if(this.height=this.$el.css("height"),this.width=this.$el.css("width"),rdocument=this.document=document,rwindow=this.window=window,this.opts.mobile===!1&&this.isMobile())return this.build(!0),!1;if(this.opts.iframe&&(this.opts.autoresize=!1),this.opts.air)this.opts.buttons=this.opts.airButtons;else if(this.opts.toolbar!==!1){if(this.opts.source===!1){var i=this.opts.buttons.indexOf("html"),o=this.opts.buttons[i+1];this.opts.buttons.splice(i,1),"undefined"!=typeof o&&"|"===o&&this.opts.buttons.splice(i,1)}t.extend(this.opts.toolbar,this.opts.buttonsCustom),t.each(this.opts.buttonsAdd,t.proxy(function(t,e){this.opts.buttons.push(e)},this))}this.opts.toolbar!==!1&&t.each(this.opts.toolbar.formatting.dropdown,t.proxy(function(e){"-1"==t.inArray(e,this.opts.formattingTags)&&delete this.opts.toolbar.formatting.dropdown[e]},this)),this.build(!1,e)},shortcuts:function(t,e){t.preventDefault(),this.execCommand(e,!1)},keyup:function(){this.$editor.keyup(t.proxy(function(t){var e=t.keyCode||t.which;return this.browser("mozilla")&&!this.pasteRunning&&this.saveSelection(),"function"==typeof this.opts.keyupCallback&&this.opts.keyupCallback(this,t),8===e||46===e?(this.observeImages(),this.formatEmpty(t)):(13!==e||t.shiftKey||t.ctrlKey||t.metaKey||(this.browser("webkit")&&this.formatNewLine(t),this.opts.convertLinks&&this.$editor.linkify()),void this.syncCode())},this))},keydown:function(){this.$editor.keydown(t.proxy(function(e){var i=e.keyCode||e.which,o=this.getParentNode(),n=this.getCurrentNode(),s=!1,a=e.ctrlKey||e.metaKey;if(!o&&!n||"PRE"!==t(o).get(0).tagName&&"PRE"!==t(n).get(0).tagName||(s=!0),"function"==typeof this.opts.keydownCallback&&this.opts.keydownCallback(this,e),a&&this.opts.shortcuts&&(90===i?this.opts.buffer!==!1?(e.preventDefault(),this.getBuffer()):e.shiftKey?this.shortcuts(e,"redo"):this.shortcuts(e,"undo"):77===i?this.shortcuts(e,"removeFormat"):66===i?this.shortcuts(e,"bold"):73===i?this.shortcuts(e,"italic"):74===i?this.shortcuts(e,"insertunorderedlist"):75===i?this.shortcuts(e,"insertorderedlist"):76===i?this.shortcuts(e,"superscript"):72===i&&this.shortcuts(e,"subscript")),a||90===i||(this.opts.buffer=!1),s===!0&&13===i){e.preventDefault();var r=t(n).parent().text();return this.insertNodeAtCaret(this.document.createTextNode("\r\n")),-1==r.search(/\s$/)&&this.insertNodeAtCaret(this.document.createTextNode("\r\n")),this.syncCode(),!1}if(this.opts.shortcuts&&!e.shiftKey&&9===i){if(s!==!1)return e.preventDefault(),this.insertNodeAtCaret(this.document.createTextNode("	")),this.syncCode(),!1;this.shortcuts(e,"indent")}else this.opts.shortcuts&&e.shiftKey&&9===i&&this.shortcuts(e,"outdent");return this.browser("webkit")&&-1===navigator.userAgent.indexOf("Chrome")?this.safariShiftKeyEnter(e,i):void 0},this))},build:function(e,i){function o(){this.$editor=this.$content.contents().find("body").attr("contenteditable",!0).attr("dir",this.opts.direction),rdocument=this.document=this.$editor[0].ownerDocument,rwindow=this.window=this.document.defaultView||window,this.opts.css!==!1&&this.$content.contents().find("head").append('<link rel="stylesheet" href="'+this.opts.css+'" />'),this.$editor.html(a),i&&(i.call(this),i=null)}if(e!==!0){if(this.$box=t('<div class="redactor_box"></div>'),this.opts.air&&(this.air=t('<div class="redactor_air" style="display: none;"></div>')),this.$content=null,this.textareamode=!0,"TEXTAREA"===this.$el.get(0).tagName){if(this.opts.iframe){var n=this;this.$content=t('<iframe style="width: 100%;" frameborder="0"></iframe>').load(function(){o.call(n)})}else this.$content=this.$editor=t("<div></div>");var s=this.$el.get(0).className.split(/\s+/);t.each(s,t.proxy(function(t,e){this.$content.addClass("redactor_"+e)},this))}else this.textareamode=!1,this.$content=this.$editor=this.$el,this.$el=t('<textarea name="'+this.$editor.attr("id")+'"></textarea>').css("height",this.height);this.$editor&&this.$editor.addClass("redactor_editor").attr("contenteditable",!0).attr("dir",this.opts.direction),this.opts.tabindex!==!1&&this.$content.attr("tabindex",this.opts.tabindex),this.opts.minHeight!==!1&&this.$content.css("min-height",this.opts.minHeight+"px"),this.opts.wym===!0&&this.$content.addClass("redactor_editor_wym"),this.opts.autoresize===!1&&this.$content.css("height",this.height),this.$el.hide();var a="";this.textareamode?(a=this.$el.val(),a=this.savePreCode(a),this.$box.insertAfter(this.$el).append(this.$content).append(this.$el)):(a=this.$editor.html(),a=this.savePreCode(a),this.$box.insertAfter(this.$content).append(this.$el).append(this.$editor)),a=this.paragraphy(a),this.$editor&&this.$editor.html(a),this.textareamode===!1&&this.syncCode()}else if("TEXTAREA"!==this.$el.get(0).tagName){var a=this.$el.val(),r=t('<textarea name="'+this.$editor.attr("id")+'"></textarea>').css("height",this.height).val(a);this.$el.hide(),this.$el.after(r)}i&&this.$editor&&i.call(this)},enableAir:function(){return this.opts.air===!1?!1:(this.air.hide(),this.$editor.bind("textselect",t.proxy(function(t){this.showAir(t)},this)),void this.$editor.bind("textunselect",t.proxy(function(){this.air.hide()},this)))},showAir:function(e){t(".redactor_air").hide();var i=this.air.innerWidth(),o=e.clientX;t(this.document).width()<o+i&&(o-=i);var n=e.clientY+t(document).scrollTop()+14;this.opts.iframe===!0&&(n+=this.$box.position().top,o+=this.$box.position().left),this.air.css({left:o+"px",top:n+"px"}).show()},syncCode:function(){this.$el.val(this.$editor.html())},setCode:function(t){t=this.stripTags(t),this.$editor.html(t).focus(),this.syncCode()},getCode:function(){var t="";return t=this.opts.visual?this.$editor.html():this.$el.val(),this.stripTags(t)},insertHtml:function(t){this.$editor.focus(),this.pasteHtmlAtCaret(t),this.observeImages(),this.syncCode()},pasteHtmlAtCaret:function(t){var e,i;if(this.document.getSelection){if(e=this.window.getSelection(),e.getRangeAt&&e.rangeCount){i=e.getRangeAt(0),i.deleteContents();var o=this.document.createElement("div");o.innerHTML=t;for(var n,s,a=this.document.createDocumentFragment();n=o.firstChild;)s=a.appendChild(n);i.insertNode(a),s&&(i=i.cloneRange(),i.setStartAfter(s),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else this.document.selection&&"Control"!=this.document.selection.type&&this.document.selection.createRange().pasteHTML(t)},destroy:function(){var e=this.getCode();this.textareamode?(this.$box.after(this.$el),this.$box.remove(),this.$el.height(this.height).val(e).show()):(this.$box.after(this.$editor),this.$box.remove(),this.$editor.removeClass("redactor_editor").removeClass("redactor_editor_wym").attr("contenteditable",!1).html(e).show()),this.opts.toolbarExternal&&t(this.opts.toolbarExternal).empty(),t(".redactor_air").remove();for(var i=0;i<this.dropdowns.length;i++)this.dropdowns[i].remove(),delete this.dropdowns[i];this.opts.autosave!==!1&&clearInterval(this.autosaveInterval)},observeFormatting:function(){var e=this.getCurrentNode();this.inactiveAllButtons(),t.each(this.opts.activeButtonsStates,t.proxy(function(i,o){0!=t(e).closest(i,this.$editor.get()[0]).length&&this.setBtnActive(o)},this));var i=t(e).closest(["p","div","h1","h2","h3","h4","h5","h6","blockquote","td"]);if("undefined"!=typeof i[0]&&"undefined"!=typeof i[0].elem&&0!=t(i[0].elem).size()){var o=t(i[0].elem).css("text-align");switch(o){case"right":this.setBtnActive("alignright");break;case"center":this.setBtnActive("aligncenter");break;case"justify":this.setBtnActive("justify");break;default:this.setBtnActive("alignleft")}}},observeImages:function(){return this.opts.observeImages===!1?!1:void this.$editor.find("img").each(t.proxy(function(e,i){this.browser("msie")&&t(i).attr("unselectable","on"),this.resizeImage(i)},this))},observeTables:function(){this.$editor.find("table").click(t.proxy(this.tableObserver,this))},observeScroll:function(){var e=t(this.document).scrollTop(),i=this.$box.offset().top,o=0;if(e>i){var n="100%";this.opts.fixedBox&&(o=this.$box.offset().left,n=this.$box.innerWidth()),this.fixed=!0,this.$toolbar.css({position:"fixed",width:n,zIndex:1005,top:this.opts.fixedTop+"px",left:o})}else this.fixed=!1,this.$toolbar.css({position:"relative",width:"auto",zIndex:1,top:0,left:o})},setBuffer:function(){this.saveSelection(),this.opts.buffer=this.$editor.html()},getBuffer:function(){return this.opts.buffer===!1?!1:(this.$editor.html(this.opts.buffer),this.browser("msie")||this.restoreSelection(),void(this.opts.buffer=!1))},execCommand:function(e,i){if(0==this.opts.visual)return this.$el.focus(),!1;try{var o;if("inserthtml"===e)this.browser("msie")?(this.$editor.focus(),this.document.selection.createRange().pasteHTML(i)):this.pasteHtmlAtCaret(i),this.observeImages();else if("unlink"===e)o=this.getParentNode(),"A"===t(o).get(0).tagName?t(o).replaceWith(t(o).text()):this.execRun(e,i);else if("JustifyLeft"===e||"JustifyCenter"===e||"JustifyRight"===e||"JustifyFull"===e){o=this.getCurrentNode();var n=t(o).get(0).tagName;if(this.opts.iframe===!1&&0==t(o).parents(".redactor_editor").size())return!1;var s=["P","DIV","H1","H2","H3","H4","H5","H6","BLOCKQUOTE","TD"];if(-1!=t.inArray(n,s)){var a=!1;"JustifyCenter"===e?a="center":"JustifyRight"===e?a="right":"JustifyFull"===e&&(a="justify"),a===!1?t(o).css("text-align",""):t(o).css("text-align",a)}else this.execRun(e,i)}else if("formatblock"===e&&"blockquote"===i)if(o=this.getCurrentNode(),"BLOCKQUOTE"===t(o).get(0).tagName)if(this.browser("msie")){var r=t("<p>"+t(o).html()+"</p>");t(o).replaceWith(r)}else this.execRun(e,"p");else if("P"===t(o).get(0).tagName){var l=t(o).parent();if("BLOCKQUOTE"===t(l).get(0).tagName){var r=t("<p>"+t(o).html()+"</p>");t(l).replaceWith(r),this.setSelection(r[0],0,r[0],0)}else if(this.browser("msie")){var r=t("<blockquote>"+t(o).html()+"</blockquote>");t(o).replaceWith(r)}else this.execRun(e,i)}else this.execRun(e,i);else"formatblock"!==e||"pre"!==i&&"p"!==i?("inserthorizontalrule"===e&&this.browser("msie")&&this.$editor.focus(),"formatblock"===e&&this.browser("mozilla")&&this.$editor.focus(),this.execRun(e,i)):(o=this.getParentNode(),"PRE"===t(o).get(0).tagName?t(o).replaceWith("<p>"+this.encodeEntities(t(o).text())+"</p>"):this.execRun(e,i));"inserthorizontalrule"===e&&this.$editor.find("hr").removeAttr("id"),this.syncCode(),this.oldIE()&&this.$editor.focus(),"function"==typeof this.opts.execCommandCallback&&this.opts.execCommandCallback(this,e),this.opts.air&&this.air.hide()}catch(d){}},execRun:function(t,e){"formatblock"===t&&this.browser("msie")&&(e="<"+e+">"),this.document.execCommand(t,!1,e)},formatNewLine:function(){var e=this.getParentNode();if("DIV"===e.nodeName&&"redactor_editor"===e.className){var i=t(this.getCurrentNode());if("DIV"===i.get(0).tagName&&(""===i.html()||"<br>"===i.html())){var o=t("<p>").append(i.clone().get(0).childNodes);i.replaceWith(o),o.html("<br />"),this.setSelection(o[0],0,o[0],0)}}},safariShiftKeyEnter:function(e,i){return e.shiftKey&&13===i?(e.preventDefault(),this.insertNodeAtCaret(t("<span><br /></span>").get(0)),this.syncCode(),!1):!0},formatEmpty:function(e){var i=t.trim(this.$editor.html());this.browser("mozilla")&&(i=i.replace(/<br>/i,""));var o=i.replace(/<(?:.|\n)*?>/gm,"");if(""===i||""===o){e.preventDefault();var n=t(this.opts.emptyHtml).get(0);return this.$editor.html(n),this.setSelection(n,0,n,0),this.syncCode(),!1}this.syncCode()},paragraphy:function(e){if(e=t.trim(e),""===e||"<p></p>"===e)return this.opts.emptyHtml;this.opts.convertDivs&&(e=e.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>"));var i=function(t,e,i){return t.replace(new RegExp(e,"g"),i)},o=function(t,o){return i(e,t,o)},n="(table|thead|tfoot|caption|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|form|blockquote|address|math|style|script|object|input|param|p|h[1-6])";return e+="\n",o("<br />\\s*<br />","\n\n"),o("(<"+n+"[^>]*>)","\n$1"),o("(</"+n+">)","$1\n\n"),o("\r\n|\r","\n"),o("\n\n+","\n\n"),o("\n?((.|\n)+?)$","<p>$1</p>\n"),o("<p>\\s*?</p>",""),o("<p>(<div[^>]*>\\s*)","$1<p>"),o("<p>([^<]+)\\s*?(</(div|address|form)[^>]*>)","<p>$1</p>$2"),o("<p>\\s*(</?"+n+"[^>]*>)\\s*</p>","$1"),o("<p>(<li.+?)</p>","$1"),o("<p>\\s*(</?"+n+"[^>]*>)","$1"),o("(</?"+n+"[^>]*>)\\s*</p>","$1"),o("(</?"+n+"[^>]*>)\\s*<br />","$1"),o("<br />(\\s*</?(p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)","$1"),-1!=e.indexOf("<pre")&&o("(<pre(.|\n)*?>)((.|\n)*?)</pre>",function(t,e,o,n){return i(e,"\\\\(['\"\\\\])","$1")+i(i(i(n,"<p>","\n"),"</p>|<br />",""),"\\\\(['\"\\\\])","$1")+"</pre>"}),o("\n</p>$","</p>")},stripTags:function(e){var i=this.opts.allowedTags,o=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return e.replace(o,function(e,o){return t.inArray(o.toLowerCase(),i)>"-1"?e:""})},savePreCode:function(e){var i=e.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==i&&t.each(i,t.proxy(function(t,i){var o=i.match(/<pre(.*?)>([\w\W]*?)<\/pre>/i);o[2]=this.encodeEntities(o[2]),e=e.replace(i,"<pre"+o[1]+">"+o[2]+"</pre>")},this)),e},encodeEntities:function(t){return t=String(t).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},cleanupPre:function(t){t=t.replace(/<br>/gi,"\n"),t=t.replace(/<\/p>/gi,"\n"),t=t.replace(/<\/div>/gi,"\n");var e=this.document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText},pasteCleanUp:function(e){var i=this.getParentNode();return"PRE"===t(i).get(0).tagName?(e=this.cleanupPre(e),this.pasteCleanUpInsert(e),!0):(e=e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,""),e=e.replace(/(&nbsp;){2,}/gi,"&nbsp;"),e=e.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),e=this.stripTags(e),e=e.replace(/<td><\/td>/gi,"[td]"),e=e.replace(/<td>&nbsp;<\/td>/gi,"[td]"),e=e.replace(/<td><br><\/td>/gi,"[td]"),e=e.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]'),e=e.replace(/<iframe(.*?)>([\w\W]*?)<\/iframe>/gi,"[iframe$1]$2[/iframe]"),e=e.replace(/<video(.*?)>([\w\W]*?)<\/video>/gi,"[video$1]$2[/video]"),e=e.replace(/<audio(.*?)>([\w\W]*?)<\/audio>/gi,"[audio$1]$2[/audio]"),e=e.replace(/<embed(.*?)>([\w\W]*?)<\/embed>/gi,"[embed$1]$2[/embed]"),e=e.replace(/<object(.*?)>([\w\W]*?)<\/object>/gi,"[object$1]$2[/object]"),e=e.replace(/<param(.*?)>/gi,"[param$1]"),e=e.replace(/<img(.*?)style="(.*?)"(.*?)>/gi,"[img$1$3]"),e=e.replace(/<(\w+)([\w\W]*?)>/gi,"<$1>"),e=e.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),e=e.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),e=e.replace(/\[td\]/gi,"<td>&nbsp;</td>"),e=e.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>'),e=e.replace(/\[iframe(.*?)\]([\w\W]*?)\[\/iframe\]/gi,"<iframe$1>$2</iframe>"),e=e.replace(/\[video(.*?)\]([\w\W]*?)\[\/video\]/gi,"<video$1>$2</video>"),e=e.replace(/\[audio(.*?)\]([\w\W]*?)\[\/audio\]/gi,"<audio$1>$2</audio>"),e=e.replace(/\[embed(.*?)\]([\w\W]*?)\[\/embed\]/gi,"<embed$1>$2</embed>"),e=e.replace(/\[object(.*?)\]([\w\W]*?)\[\/object\]/gi,"<object$1>$2</object>"),e=e.replace(/\[param(.*?)\]/gi,"<param$1>"),e=e.replace(/\[img(.*?)\]/gi,"<img$1>"),this.opts.convertDivs&&(e=e.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>")),e=e.replace(/<span>([\w\W]*?)<\/span>/gi,"$1"),e=e.replace(/\n{3,}/gi,"\n"),e=e.replace(/<p><p>/gi,"<p>"),e=e.replace(/<\/p><\/p>/gi,"</p>"),this.browser("mozilla")&&(e=e.replace(/<br>$/gi,"")),void this.pasteCleanUpInsert(e))},pasteCleanUpInsert:function(e){this.execCommand("inserthtml",e),this.opts.autoresize===!0?t(this.document.body).scrollTop(this.saveScroll):this.$editor.scrollTop(this.saveScroll)},formattingRemove:function(e){var i=[],o=e.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==o&&t.each(o,function(t,o){e=e.replace(o,"prebuffer_"+t),i.push(o)}),e=e.replace(/\s{2,}/g," "),e=e.replace(/\n/g," "),e=e.replace(/[\t]*/g,""),e=e.replace(/\n\s*\n/g,"\n"),e=e.replace(/^[\s\n]*/g,""),e=e.replace(/[\s\n]*$/g,""),e=e.replace(/>\s+</g,"><"),i&&(t.each(i,function(t,i){e=e.replace("prebuffer_"+t,i)}),i=[]),e},formattingIndenting:function(t){return t=t.replace(/<li/g,"	<li"),t=t.replace(/<tr/g,"	<tr"),t=t.replace(/<td/g,"		<td"),t=t.replace(/<\/tr>/g,"	</tr>")},formattingEmptyTags:function(t){for(var e=["<pre></pre>","<blockquote>\\s*</blockquote>","<em>\\s*</em>","<ul></ul>","<ol></ol>","<li></li>","<table></table>","<tr></tr>","<span>\\s*<span>","<span>&nbsp;<span>","<b>\\s*</b>","<b>&nbsp;</b>","<p>\\s*</p>","<p>&nbsp;</p>","<p>\\s*<br>\\s*</p>","<div>\\s*</div>","<div>\\s*<br>\\s*</div>"],i=0;i<e.length;++i){var o=e[i];t=t.replace(new RegExp(o,"gi"),"")}return t},formattingAddBefore:function(t){for(var e="\r\n",i=["<p","<form","</ul>","</ol>","<fieldset","<legend","<object","<embed","<select","<option","<input","<textarea","<pre","<blockquote","<ul","<ol","<li","<dl","<dt","<dd","<table","<thead","<tbody","<caption","</caption>","<th","<tr","<td","<figure"],o=0;o<i.length;++o){var n=i[o];t=t.replace(new RegExp(n,"gi"),e+n)}return t},formattingAddAfter:function(t){for(var e="\r\n",i=["</p>","</div>","</h1>","</h2>","</h3>","</h4>","</h5>","</h6>","<br>","<br />","</dl>","</dt>","</dd>","</form>","</blockquote>","</pre>","</legend>","</fieldset>","</object>","</embed>","</textarea>","</select>","</option>","</table>","</thead>","</tbody>","</tr>","</td>","</th>","</figure>"],o=0;o<i.length;++o){var n=i[o];t=t.replace(new RegExp(n,"gi"),n+e)}return t},formatting:function(t){return t=this.formattingRemove(t),t=this.formattingEmptyTags(t),t=this.formattingAddBefore(t),t=this.formattingAddAfter(t),t=this.formattingIndenting(t)},toggle:function(){var t;if(this.opts.visual){var e=this.$editor.innerHeight();this.$editor.hide(),this.$content.hide(),t=this.$editor.html(),this.$el.height(e).val(t).show().focus(),this.setBtnActive("html"),this.opts.visual=!1}else{this.$el.hide();var t=this.$el.val();this.$editor.html(t).show(),this.$content.show(),""===this.$editor.html()&&this.setCode(this.opts.emptyHtml),this.$editor.focus(),this.setBtnInactive("html"),this.opts.visual=!0,this.observeImages(),this.observeTables()}},autoSave:function(){this.autosaveInterval=setInterval(t.proxy(function(){t.ajax({url:this.opts.autosave,type:"post",data:this.$el.attr("name")+"="+escape(encodeURIComponent(this.getCode())),success:t.proxy(function(t){"function"==typeof this.opts.autosaveCallback&&this.opts.autosaveCallback(t,this)},this)})},this),1e3*this.opts.interval)},buildToolbar:function(){return this.opts.toolbar===!1?!1:(this.$toolbar=t("<ul>").addClass("redactor_toolbar"),this.opts.air?(t(this.air).append(this.$toolbar),t("body").append(this.air)):this.opts.toolbarExternal===!1?this.$box.prepend(this.$toolbar):t(this.opts.toolbarExternal).html(this.$toolbar),void t.each(this.opts.buttons,t.proxy(function(e,i){if("|"!==i&&"undefined"!=typeof this.opts.toolbar[i]){var o=this.opts.toolbar[i];if(this.opts.fileUpload===!1&&"file"===i)return!0;this.$toolbar.append(t("<li>").append(this.buildButton(i,o)))}"|"===i&&this.$toolbar.append(t('<li class="redactor_separator"></li>'))},this)))},buildButton:function(e,i){var o=t('<a href="javascript:void(null);" title="'+i.title+'" class="redactor_btn_'+e+'"></a>');if("undefined"==typeof i.func?o.click(t.proxy(function(){-1!=t.inArray(e,this.opts.activeButtons)&&(this.inactiveAllButtons(),this.setBtnActive(e)),this.browser("mozilla")&&this.$editor.focus(),this.execCommand(i.exec,e)},this)):"show"!==i.func&&o.click(t.proxy(function(t){this[i.func](t)},this)),"undefined"!=typeof i.callback&&i.callback!==!1&&o.click(t.proxy(function(t){i.callback(this,t,e)},this)),"backcolor"===e||"fontcolor"===e||"undefined"!=typeof i.dropdown){var n=t('<div class="redactor_dropdown" style="display: none;">');n="backcolor"===e||"fontcolor"===e?this.buildColorPicker(n,e):this.buildDropdown(n,i.dropdown),this.dropdowns.push(n.appendTo(t(document.body))),this.hdlShowDropDown=t.proxy(function(t){this.showDropDown(t,n,e)},this),o.click(this.hdlShowDropDown)}return o},buildDropdown:function(e,i){return t.each(i,t.proxy(function(i,o){"undefined"==typeof o.className&&(o.className="");var n;"undefined"!=typeof o.name&&"separator"===o.name?n=t('<a class="redactor_separator_drop">'):(n=t('<a href="javascript:void(null);" class="'+o.className+'">'+o.title+"</a>"),t(n).click("function"==typeof o.callback?t.proxy(function(t){o.callback(this,t,i)},this):"undefined"==typeof o.func?t.proxy(function(){this.execCommand(o.exec,i)},this):t.proxy(function(t){this[o.func](t)},this))),t(e).append(n)},this)),e},buildColorPicker:function(e,i){var o;o="backcolor"===i?this.browser("msie")?"BackColor":"hilitecolor":"forecolor",t(e).width(210);for(var n=this.opts.colors.length,s=0;n>s;++s){var a=this.opts.colors[s],r=t('<a rel="'+a+'" href="javascript:void(null);" class="redactor_color_link"></a>').css({backgroundColor:a});t(e).append(r);var l=this;t(r).click(function(){l.execCommand(o,t(this).attr("rel")),"forecolor"===o&&l.$editor.find("font").replaceWith(function(){return t('<span style="color: '+t(this).attr("color")+';">'+t(this).html()+"</span>")}),l.browser("msie")&&"BackColor"===o&&l.$editor.find("font").replaceWith(function(){return t('<span style="'+t(this).attr("style")+'">'+t(this).html()+"</span>")})})}var d=t('<a href="javascript:void(null);" class="redactor_color_none"></a>').html(RLANG.none);return d.click("backcolor"===i?t.proxy(this.setBackgroundNone,this):t.proxy(this.setColorNone,this)),t(e).append(d),e},setBackgroundNone:function(){t(this.getParentNode()).css("background-color","transparent"),this.syncCode()},setColorNone:function(){t(this.getParentNode()).attr("color","").css("color",""),this.syncCode()},showDropDown:function(e,i,o){if(this.getBtn(o).hasClass("dropact"))this.hideAllDropDown();else{this.hideAllDropDown(),this.setBtnActive(o),this.getBtn(o).addClass("dropact");var n=this.getBtn(o).offset().left;if(this.opts.air){var s=this.air.offset().top;t(i).css({position:"absolute",left:n+"px",top:s+30+"px"}).show()}else if(this.opts.fixed&&this.fixed)t(i).css({position:"fixed",left:n+"px",top:"30px"}).show();else{var a=this.$toolbar.offset().top+30;t(i).css({position:"absolute",left:n+"px",top:a+"px"}).show()}}var r=t.proxy(function(t){this.hideDropDown(t,i,o)},this);t(document).one("click",r),this.$editor.one("click",r),this.$content.one("click",r),e.stopPropagation()},hideAllDropDown:function(){this.$toolbar.find("a.dropact").removeClass("redactor_act").removeClass("dropact"),t(".redactor_dropdown").hide()},hideDropDown:function(e,i){t(e.target).hasClass("dropact")||(t(i).removeClass("dropact"),this.showedDropDown=!1,this.hideAllDropDown())},getBtn:function(e){return this.opts.toolbar===!1?!1:t(this.$toolbar.find("a.redactor_btn_"+e))},setBtnActive:function(t){this.getBtn(t).addClass("redactor_act")},setBtnInactive:function(t){this.getBtn(t).removeClass("redactor_act")},inactiveAllButtons:function(){t.each(this.opts.activeButtons,t.proxy(function(t,e){this.setBtnInactive(e)},this))},changeBtnIcon:function(t,e){this.getBtn(t).addClass("redactor_btn_"+e)},removeBtnIcon:function(t,e){this.getBtn(t).removeClass("redactor_btn_"+e)},addBtnSeparator:function(){this.$toolbar.append(t('<li class="redactor_separator"></li>'))},addBtnSeparatorAfter:function(e){var i=this.getBtn(e);i.parent().after(t('<li class="redactor_separator"></li>'))},addBtnSeparatorBefore:function(e){var i=this.getBtn(e);i.parent().before(t('<li class="redactor_separator"></li>'))},removeBtnSeparatorAfter:function(t){var e=this.getBtn(t);e.parent().next().remove()},removeBtnSeparatorBefore:function(t){var e=this.getBtn(t);e.parent().prev().remove()},setBtnRight:function(t){return this.opts.toolbar===!1?!1:void this.getBtn(t).parent().addClass("redactor_btn_right")},setBtnLeft:function(t){return this.opts.toolbar===!1?!1:void this.getBtn(t).parent().removeClass("redactor_btn_right")},addBtn:function(e,i,o,n){if(this.opts.toolbar===!1)return!1;var s=this.buildButton(e,{title:i,callback:o,dropdown:n});this.$toolbar.append(t("<li>").append(s))},addBtnFirst:function(e,i,o,n){if(this.opts.toolbar===!1)return!1;var s=this.buildButton(e,{title:i,callback:o,dropdown:n});this.$toolbar.prepend(t("<li>").append(s))},addBtnAfter:function(e,i,o,n,s){if(this.opts.toolbar===!1)return!1;var a=this.buildButton(i,{title:o,callback:n,dropdown:s}),r=this.getBtn(e);r.parent().after(t("<li>").append(a))},addBtnBefore:function(e,i,o,n,s){if(this.opts.toolbar===!1)return!1;var a=this.buildButton(i,{title:o,callback:n,dropdown:s}),r=this.getBtn(e);r.parent().before(t("<li>").append(a))},removeBtn:function(t,e){var i=this.getBtn(t);e===!0&&i.parent().next().remove(),i.parent().removeClass("redactor_btn_right"),i.remove()},getFragmentHtml:function(t){var e=t.cloneNode(!0),i=this.document.createElement("div");return i.appendChild(e),i.innerHTML},extractContent:function(){for(var t,e=this.$editor.get(0),i=this.document.createDocumentFragment();t=e.firstChild;)i.appendChild(t);return i},saveSelection:function(){this.$editor.focus(),this.savedSel=this.getOrigin(),this.savedSelObj=this.getFocus()},restoreSelection:function(){"undefined"!=typeof this.savedSel&&null!==this.savedSel&&null!==this.savedSelObj&&"BODY"!==this.savedSel[0].tagName?this.opts.iframe===!1&&0==t(this.savedSel[0]).closest(".redactor_editor").size()?this.$editor.focus():(this.browser("opera")&&this.$editor.focus(),this.setSelection(this.savedSel[0],this.savedSel[1],this.savedSelObj[0],this.savedSelObj[1]),this.browser("mozilla")&&this.$editor.focus()):this.$editor.focus()},getSelection:function(){var t=this.document;return this.window.getSelection?this.window.getSelection():t.getSelection?t.getSelection():t.selection.createRange()},hasSelection:function(){if(this.oldIE()){var t,e=this.$editor.get(0);return e.focus(),e.document.selection?(t=e.document.selection.createRange(),t&&t.parentElement().document===e.document):!1}var i;return(i=this.getSelection())&&null!=i.focusNode&&null!=i.anchorNode},getOrigin:function(){if(this.oldIE()){var t,e=this.$editor.get(0);return e.focus(),this.hasSelection()?(t=e.document.selection.createRange(),this._getBoundary(e.document,t,!0)):null}var i;return(i=this.getSelection())&&null!=i.anchorNode?[i.anchorNode,i.anchorOffset]:null},getFocus:function(){if(this.oldIE()){var t,e=this.$editor.get(0);return e.focus(),this.hasSelection()?(t=e.document.selection.createRange(),this._getBoundary(e.document,t,!1)):null}var i;return(i=this.getSelection())&&null!=i.focusNode?[i.focusNode,i.focusOffset]:null},setSelection:function(t,e,i,o){if(null==i&&(i=t),null==o&&(o=e),this.oldIE()){var n=this.$editor.get(0),s=n.document.body.createTextRange();return this._moveBoundary(n.document,s,!1,i,o),this._moveBoundary(n.document,s,!0,t,e),s.select()}var a=this.getSelection();if(a)if(a.collapse&&a.extend)a.collapse(t,e),a.extend(i,o);else{r=this.document.createRange(),r.setStart(t,e),r.setEnd(i,o);try{a.removeAllRanges()}catch(l){}a.addRange(r)}},getCurrentNode:function(){return"undefined"!=typeof this.window.getSelection?this.getSelectedNode().parentNode:"undefined"!=typeof this.document.selection?this.getSelection().parentElement():void 0},getParentNode:function(){return t(this.getCurrentNode()).parent()[0]},getSelectedNode:function(){if(this.oldIE())return this.getSelection().parentElement();if("undefined"!=typeof this.window.getSelection){var t=this.window.getSelection();return t.rangeCount>0?this.getSelection().getRangeAt(0).commonAncestorContainer:!1}return"undefined"!=typeof this.document.selection?this.getSelection():void 0},_getBoundary:function(t,e,i){var o,n,s,a,r;for(n=t.createElement("a"),o=e.duplicate(),o.collapse(i),r=o.parentElement();;)if(r.insertBefore(n,n.previousSibling),o.moveToElementText(n),!(o.compareEndPoints(i?"StartToStart":"StartToEnd",e)>0&&null!=n.previousSibling))break;return-1===o.compareEndPoints(i?"StartToStart":"StartToEnd",e)&&n.nextSibling?(o.setEndPoint(i?"EndToStart":"EndToEnd",e),s=n.nextSibling,a=o.text.length):(s=n.parentNode,a=this._getChildIndex(n)),n.parentNode.removeChild(n),[s,a]},_moveBoundary:function(t,e,i,o,n){var s,a,r,l,d;return d=0,s=this._isText(o)?o:o.childNodes[n],a=this._isText(o)?o.parentNode:o,this._isText(o)&&(d=n),l=t.createElement("a"),a.insertBefore(l,s||null),r=t.body.createTextRange(),r.moveToElementText(l),l.parentNode.removeChild(l),e.setEndPoint(i?"StartToStart":"EndToEnd",r),e[i?"moveStart":"moveEnd"]("character",d)},_isText:function(t){return null!=t?3==t.nodeType:!1},_getChildIndex:function(t){for(var e=0;t=t.previousSibling;)e++;return e},insertNodeAfterCaret:function(t){this.saveSelection(),this.insertNodeAtCaret(t),this.restoreSelection()},insertNodeAtCaret:function(t){if(this.window.getSelection){var e=this.getSelection();if(e.rangeCount){var i=e.getRangeAt(0);i.collapse(!1),i.insertNode(t),i=i.cloneRange(),i.selectNodeContents(t),i.collapse(!1),e.removeAllRanges(),e.addRange(i)}}else if(this.document.selection){var o=1===t.nodeType?t.outerHTML:t.data,n="marker_"+(""+Math.random()).slice(2);o+='<span id="'+n+'"></span>';var s=this.getSelection();s.collapse(!1),s.pasteHTML(o);var a=this.document.getElementById(n);s.moveToElementText(a),s.select(),a.parentNode.removeChild(a)}},getSelectedHtml:function(){var t="";if(this.window.getSelection){var e=this.window.getSelection();if(e.rangeCount){for(var i=this.document.createElement("div"),o=0,n=e.rangeCount;n>o;++o)i.appendChild(e.getRangeAt(o).cloneContents());t=i.innerHTML}}else this.document.selection&&"Text"===this.document.selection.type&&(t=this.document.selection.createRange().htmlText);return t},resizeImage:function(e){var i,o,n=!1,s=!1,a=t(e).width()/t(e).height(),r=10,l=10;t(e).off("hover mousedown mouseup click mousemove"),t(e).hover(function(){t(e).css("cursor","nw-resize")},function(){t(e).css("cursor",""),n=!1}),t(e).mousedown(function(r){r.preventDefault(),a=t(e).width()/t(e).height(),n=!0,s=!0,i=Math.round(r.pageX-t(e).eq(0).offset().left),o=Math.round(r.pageY-t(e).eq(0).offset().top)}),t(e).mouseup(t.proxy(function(){n=!1,t(e).css("cursor",""),this.syncCode()},this)),t(e).click(t.proxy(function(t){s&&this.imageEdit(t)},this)),t(e).mousemove(function(d){if(n){s=!1;var c=(Math.round(d.pageX-t(this).eq(0).offset().left)-i,Math.round(d.pageY-t(this).eq(0).offset().top)-o),h=t(e).height(),u=parseInt(h,10)+c,p=u*a;p>r&&t(e).width(p),u>l&&t(e).height(u),i=Math.round(d.pageX-t(this).eq(0).offset().left),o=Math.round(d.pageY-t(this).eq(0).offset().top)
}})},showTable:function(){this.saveSelection(),this.modalInit(RLANG.table,this.opts.modal_table,300,t.proxy(function(){t("#redactor_insert_table_btn").click(t.proxy(this.insertTable,this)),setTimeout(function(){t("#redactor_table_rows").focus()},200)},this))},insertTable:function(){for(var e=t("#redactor_table_rows").val(),i=t("#redactor_table_columns").val(),o=t("<div></div>"),n=Math.floor(99999*Math.random()),s=t('<table id="table'+n+'"><tbody></tbody></table>'),a=0;e>a;a++){for(var r=t("<tr></tr>"),l=0;i>l;l++){var d=t("<td><br></td>");t(r).append(d)}t(s).append(r)}t(o).append(s);var c=t(o).html()+"<p></p>";this.restoreSelection(),this.execCommand("inserthtml",c),this.modalClose(),this.observeTables()},tableObserver:function(e){this.$table=t(e.target).closest("table"),this.$table_tr=this.$table.find("tr"),this.$table_td=this.$table.find("td"),this.$tbody=t(e.target).closest("tbody"),this.$thead=t(this.$table).find("thead"),this.$current_td=t(e.target),this.$current_tr=t(e.target).closest("tr")},deleteTable:function(){t(this.$table).remove(),this.$table=!1,this.syncCode()},deleteRow:function(){t(this.$current_tr).remove(),this.syncCode()},deleteColumn:function(){var e=t(this.$current_td).get(0).cellIndex;t(this.$table).find("tr").each(function(){t(this).find("td").eq(e).remove()}),this.syncCode()},addHead:function(){if(0!==t(this.$table).find("thead").size())this.deleteHead();else{var e=t(this.$table).find("tr").first().clone();e.find("td").html("&nbsp;"),this.$thead=t("<thead></thead>"),this.$thead.append(e),t(this.$table).prepend(this.$thead),this.syncCode()}},deleteHead:function(){t(this.$thead).remove(),this.$thead=!1,this.syncCode()},insertRowAbove:function(){this.insertRow("before")},insertRowBelow:function(){this.insertRow("after")},insertColumnLeft:function(){this.insertColumn("before")},insertColumnRight:function(){this.insertColumn("after")},insertRow:function(e){var i=t(this.$current_tr).clone();i.find("td").html("&nbsp;"),"after"===e?t(this.$current_tr).after(i):t(this.$current_tr).before(i),this.syncCode()},insertColumn:function(e){var i=0;this.$current_tr.find("td").each(t.proxy(function(e,o){t(o)[0]===this.$current_td[0]&&(i=e)},this)),this.$table_tr.each(function(o,n){var s=t(n).find("td").eq(i),a=s.clone();a.html("&nbsp;"),"after"===e?t(s).after(a):t(s).before(a)}),this.syncCode()},showVideo:function(){this.saveSelection(),this.modalInit(RLANG.video,this.opts.modal_video,600,t.proxy(function(){t("#redactor_insert_video_btn").click(t.proxy(this.insertVideo,this)),setTimeout(function(){t("#redactor_insert_video_area").focus()},200)},this))},insertVideo:function(){var e=t("#redactor_insert_video_area").val();e=this.stripTags(e),this.restoreSelection(),this.execCommand("inserthtml",e),this.modalClose()},imageEdit:function(e){var i=t(e.target),o=i.parent(),n=t.proxy(function(){t("#redactor_file_alt").val(i.attr("alt")),t("#redactor_image_edit_src").attr("href",i.attr("src")),t("#redactor_form_image_align").val(i.css("float")),"A"===t(o).get(0).tagName&&t("#redactor_file_link").val(t(o).attr("href")),t("#redactor_image_delete_btn").click(t.proxy(function(){this.imageDelete(i)},this)),t("#redactorSaveBtn").click(t.proxy(function(){this.imageSave(i)},this))},this);this.modalInit(RLANG.image,this.opts.modal_image_edit,380,n)},imageDelete:function(e){t(e).remove(),this.modalClose(),this.syncCode()},imageSave:function(e){var i=t(e).parent();t(e).attr("alt",t("#redactor_file_alt").val());var o=t("#redactor_form_image_align").val();t(e).css("left"===o?{"float":"left",margin:"0 10px 10px 0"}:"right"===o?{"float":"right",margin:"0 0 10px 10px"}:{"float":"none",margin:"0"});var n=t.trim(t("#redactor_file_link").val());""!==n?"A"!==t(i).get(0).tagName?t(e).replaceWith('<a href="'+n+'">'+this.outerHTML(e)+"</a>"):t(i).attr("href",n):"A"===t(i).get(0).tagName&&t(i).replaceWith(this.outerHTML(e)),this.modalClose(),this.observeImages(),this.syncCode()},showImage:function(){this.saveSelection();var e=t.proxy(function(){if(this.opts.imageGetJson!==!1?t.getJSON(this.opts.imageGetJson,t.proxy(function(e){var i={},o=0;t.each(e,t.proxy(function(t,e){"undefined"!=typeof e.folder&&(o++,i[e.folder]=o)},this));var n=!1;if(t.each(e,t.proxy(function(e,o){var s="";"undefined"!=typeof o.title&&(s=o.title);var a=0;t.isEmptyObject(i)||"undefined"==typeof o.folder||(a=i[o.folder],n===!1&&(n=".redactorfolder"+a));var r=t('<img src="'+o.thumb+'" class="redactorfolder redactorfolder'+a+'" rel="'+o.image+'" title="'+s+'" />');t("#redactor_image_box").append(r),t(r).click(t.proxy(this.imageSetThumb,this))},this)),!t.isEmptyObject(i)){t(".redactorfolder").hide(),t(n).show();var s=function(e){t(".redactorfolder").hide(),t(".redactorfolder"+t(e.target).val()).show()},a=t('<select id="redactor_image_box_select">');t.each(i,function(e,i){a.append(t('<option value="'+i+'">'+e+"</option>"))}),t("#redactor_image_box").before(a),a.change(s)}},this)):t("#redactor_tabs a").eq(1).remove(),this.opts.imageUpload!==!1)this.opts.uploadCrossDomain===!1&&this.isMobile()===!1&&0!==t("#redactor_file").size()&&t("#redactor_file").dragupload({url:this.opts.imageUpload,uploadFields:this.opts.uploadFields,success:t.proxy(this.imageUploadCallback,this),error:t.proxy(this.opts.imageUploadErrorCallback,this)}),this.uploadInit("redactor_file",{auto:!0,url:this.opts.imageUpload,success:t.proxy(this.imageUploadCallback,this),error:t.proxy(this.opts.imageUploadErrorCallback,this)});else if(t(".redactor_tab").hide(),this.opts.imageGetJson===!1)t("#redactor_tabs").remove(),t("#redactor_tab3").show();else{var e=t("#redactor_tabs a");e.eq(0).remove(),e.eq(1).addClass("redactor_tabs_act"),t("#redactor_tab2").show()}t("#redactor_upload_btn").click(t.proxy(this.imageUploadCallbackLink,this)),this.opts.imageUpload===!1&&this.opts.imageGetJson===!1&&setTimeout(function(){t("#redactor_file_link").focus()},200)},this);this.modalInit(RLANG.image,this.opts.modal_image,610,e)},imageSetThumb:function(e){this._imageSet('<img src="'+t(e.target).attr("rel")+'" alt="'+t(e.target).attr("title")+'" />',!0)},imageUploadCallbackLink:function(){if(""!==t("#redactor_file_link").val()){var e='<img src="'+t("#redactor_file_link").val()+'" />';this._imageSet(e,!0)}else this.modalClose()},imageUploadCallback:function(t){this._imageSet(t)},_imageSet:function(t,e){if(this.restoreSelection(),t!==!1){var i="";i=e!==!0?'<p><img src="'+t.filelink+'" /></p>':t,this.execCommand("inserthtml",i),e!==!0&&"function"==typeof this.opts.imageUploadCallback&&this.opts.imageUploadCallback(this,t)}this.modalClose(),this.observeImages()},showLink:function(){this.saveSelection();var e=t.proxy(function(){this.insert_link_node=!1;var e=this.getSelection(),i="",o="",n="";if(this.browser("msie")){var s=this.getParentNode();"A"===s.nodeName?(this.insert_link_node=t(s),o=this.insert_link_node.text(),i=this.insert_link_node.attr("href"),n=this.insert_link_node.attr("target")):o=this.oldIE()?e.text:e.toString()}else e&&e.anchorNode&&"A"===e.anchorNode.parentNode.tagName?(i=e.anchorNode.parentNode.href,o=e.anchorNode.parentNode.text,n=e.anchorNode.parentNode.target,""===e.toString()&&(this.insert_link_node=e.anchorNode.parentNode)):o=e.toString();t(".redactor_link_text").val(o);var a=self.location.href.replace(/\/$/i,""),r=i.replace(a,"");0===i.search("mailto:")?(this.setModalTab(2),t("#redactor_tab_selected").val(2),t("#redactor_link_mailto").val(i.replace("mailto:",""))):0===r.search(/^#/gi)?(this.setModalTab(3),t("#redactor_tab_selected").val(3),t("#redactor_link_anchor").val(r.replace(/^#/gi,""))):t("#redactor_link_url").val(r),"_blank"===n&&t("#redactor_link_blank").attr("checked",!0),t("#redactor_insert_link_btn").click(t.proxy(this.insertLink,this)),setTimeout(function(){t("#redactor_link_url").focus()},200)},this);this.modalInit(RLANG.link,this.opts.modal_link,460,e)},insertLink:function(){var e=t("#redactor_tab_selected").val(),i="",o="",n="";if("1"===e){i=t("#redactor_link_url").val(),o=t("#redactor_link_url_text").val(),t("#redactor_link_blank").attr("checked")&&(n=' target="_blank"');var s="/(w+:{0,1}w*@)?(S+)(:[0-9]+)?(/|/([w#!:.?+=&%@!-/]))?/",a=new RegExp("^(http|ftp|https)://"+s,"i"),r=new RegExp("^"+s,"i");-1==i.search(a)&&0==i.search(r)&&this.opts.protocol!==!1&&(i=this.opts.protocol+i)}else"2"===e?(i="mailto:"+t("#redactor_link_mailto").val(),o=t("#redactor_link_mailto_text").val()):"3"===e&&(i="#"+t("#redactor_link_anchor").val(),o=t("#redactor_link_anchor_text").val());this._insertLink('<a href="'+i+'"'+n+">"+o+"</a>",t.trim(o),i,n)},_insertLink:function(e,i,o,n){this.$editor.focus(),this.restoreSelection(),""!==i&&(this.insert_link_node?(t(this.insert_link_node).text(i),t(this.insert_link_node).attr("href",o),""!==n?t(this.insert_link_node).attr("target",n):t(this.insert_link_node).removeAttr("target"),this.syncCode()):this.execCommand("inserthtml",e)),this.modalClose()},showFile:function(){this.saveSelection();var e=t.proxy(function(){var e=this.getSelection(),i="";i=this.oldIE()?e.text:e.toString(),t("#redactor_filename").val(i),this.opts.uploadCrossDomain===!1&&this.isMobile()===!1&&t("#redactor_file").dragupload({url:this.opts.fileUpload,uploadFields:this.opts.uploadFields,success:t.proxy(this.fileUploadCallback,this),error:t.proxy(this.opts.fileUploadErrorCallback,this)}),this.uploadInit("redactor_file",{auto:!0,url:this.opts.fileUpload,success:t.proxy(this.fileUploadCallback,this),error:t.proxy(this.opts.fileUploadErrorCallback,this)})},this);this.modalInit(RLANG.file,this.opts.modal_file,500,e)},fileUploadCallback:function(e){if(this.restoreSelection(),e!==!1){var i=t("#redactor_filename").val();""===i&&(i=e.filename);var o='<a href="'+e.filelink+'">'+i+"</a>";this.browser("webkit")&&this.window.chrome&&(o+="&nbsp;"),this.execCommand("inserthtml",o),"function"==typeof this.opts.fileUploadCallback&&this.opts.fileUploadCallback(this,e)}this.modalClose()},modalInit:function(e,i,o,n){if(0===t("#redactor_modal_overlay").size()&&(this.overlay=t('<div id="redactor_modal_overlay" style="display: none;"></div>'),t("body").prepend(this.overlay)),this.opts.overlay&&(t("#redactor_modal_overlay").show(),t("#redactor_modal_overlay").click(t.proxy(this.modalClose,this))),0===t("#redactor_modal").size()&&(this.modal=t('<div id="redactor_modal" style="display: none;"><div id="redactor_modal_close">&times;</div><div id="redactor_modal_header"></div><div id="redactor_modal_inner"></div></div>'),t("body").append(this.modal)),t("#redactor_modal_close").click(t.proxy(this.modalClose,this)),this.hdlModalClose=t.proxy(function(t){return 27===t.keyCode?(this.modalClose(),!1):void 0},this),t(document).keyup(this.hdlModalClose),this.$editor.keyup(this.hdlModalClose),t("#redactor_modal_inner").empty().append(0==i.indexOf("#")?t(i).html():i),t("#redactor_modal_header").html(e),"undefined"!=typeof t.fn.draggable&&(t("#redactor_modal").draggable({handle:"#redactor_modal_header"}),t("#redactor_modal_header").css("cursor","move")),0!==t("#redactor_tabs").size()){var s=this;t("#redactor_tabs a").each(function(e,i){e++,t(i).click(function(){if(t("#redactor_tabs a").removeClass("redactor_tabs_act"),t(this).addClass("redactor_tabs_act"),t(".redactor_tab").hide(),t("#redactor_tab"+e).show(),t("#redactor_tab_selected").val(e),s.isMobile()===!1){var i=t("#redactor_modal").outerHeight();t("#redactor_modal").css("margin-top","-"+(i+10)/2+"px")}})})}t("#redactor_modal .redactor_btn_modal_close").click(t.proxy(this.modalClose,this)),this.isMobile()===!1?(t("#redactor_modal").css({position:"fixed",top:"-2000px",left:"50%",width:o+"px",marginLeft:"-"+(o+60)/2+"px"}).show(),this.modalSaveBodyOveflow=t(document.body).css("overflow"),t(document.body).css("overflow","hidden")):t("#redactor_modal").css({position:"fixed",width:"100%",height:"100%",top:"0",left:"0",margin:"0",minHeight:"300px"}).show(),"function"==typeof n&&n(),this.isMobile()===!1&&setTimeout(function(){var e=t("#redactor_modal").outerHeight();t("#redactor_modal").css({top:"50%",height:"auto",minHeight:"auto",marginTop:"-"+(e+10)/2+"px"})},20)},modalClose:function(){return t("#redactor_modal_close").unbind("click",this.modalClose),t("#redactor_modal").fadeOut("fast",t.proxy(function(){t("#redactor_modal_inner").html(""),this.opts.overlay&&(t("#redactor_modal_overlay").hide(),t("#redactor_modal_overlay").unbind("click",this.modalClose)),t(document).unbind("keyup",this.hdlModalClose),this.$editor.unbind("keyup",this.hdlModalClose)},this)),this.isMobile()===!1&&t(document.body).css("overflow",this.modalSaveBodyOveflow?this.modalSaveBodyOveflow:"visible"),!1},setModalTab:function(e){t(".redactor_tab").hide();var i=t("#redactor_tabs a");i.removeClass("redactor_tabs_act"),i.eq(e-1).addClass("redactor_tabs_act"),t("#redactor_tab"+e).show()},uploadInit:function(e,i){this.uploadOptions={url:!1,success:!1,error:!1,start:!1,trigger:!1,auto:!1,input:!1},t.extend(this.uploadOptions,i),0!==t("#"+e).size()&&"INPUT"===t("#"+e).get(0).tagName?(this.uploadOptions.input=t("#"+e),this.element=t(t("#"+e).get(0).form)):this.element=t("#"+e),this.element_action=this.element.attr("action"),this.uploadOptions.auto?t(this.uploadOptions.input).change(t.proxy(function(){this.element.submit(function(){return!1}),this.uploadSubmit()},this)):this.uploadOptions.trigger&&t("#"+this.uploadOptions.trigger).click(t.proxy(this.uploadSubmit,this))},uploadSubmit:function(){this.uploadForm(this.element,this.uploadFrame())},uploadFrame:function(){this.id="f"+Math.floor(99999*Math.random());var e=this.document.createElement("div"),i='<iframe style="display:none" id="'+this.id+'" name="'+this.id+'"></iframe>';return e.innerHTML=i,t(e).appendTo("body"),this.uploadOptions.start&&this.uploadOptions.start(),t("#"+this.id).load(t.proxy(this.uploadLoaded,this)),this.id},uploadForm:function(e,i){if(this.uploadOptions.input){var o="redactorUploadForm"+this.id,n="redactorUploadFile"+this.id;this.form=t('<form  action="'+this.uploadOptions.url+'" method="POST" target="'+i+'" name="'+o+'" id="'+o+'" enctype="multipart/form-data"></form>'),this.opts.uploadFields!==!1&&"object"==typeof this.opts.uploadFields&&t.each(this.opts.uploadFields,t.proxy(function(e,i){0===i.toString().indexOf("#")&&(i=t(i).val());var o=t("<input/>",{type:"hidden",name:e,value:i});t(this.form).append(o)},this));var s=this.uploadOptions.input,a=t(s).clone();t(s).attr("id",n),t(s).before(a),t(s).appendTo(this.form),t(this.form).css("position","absolute"),t(this.form).css("top","-2000px"),t(this.form).css("left","-2000px"),t(this.form).appendTo("body"),this.form.submit()}else e.attr("target",i),e.attr("method","POST"),e.attr("enctype","multipart/form-data"),e.attr("action",this.uploadOptions.url),this.element.submit()},uploadLoaded:function(){var e,i=t("#"+this.id)[0];if(e=i.contentDocument?i.contentDocument:i.contentWindow?i.contentWindow.document:window.frames[this.id].document,this.uploadOptions.success)if("undefined"!=typeof e){var o=e.body.innerHTML,n=o.match(/\{(.|\n)*\}/)[0],s=t.parseJSON(n);"undefined"==typeof s.error?this.uploadOptions.success(s):(this.uploadOptions.error(this,s),this.modalClose())}else alert("Upload failed!"),this.modalClose();this.element.attr("action",this.element_action),this.element.attr("target","")},browser:function(t){var e=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return"version"==t?i[2]:"webkit"==t?"chrome"==i[1]||"webkit"==i[1]:i[1]==t},oldIE:function(){return this.browser("msie")&&parseInt(this.browser("version"),10)<9?!0:!1},outerHTML:function(e){return t("<p>").append(t(e).eq(0).clone()).html()},normalize:function(t){return parseInt(t.replace("px",""),10)},isMobile:function(t){return t===!0&&/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)?!0:/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)?!0:!1}},t.fn.getObject=function(){return this.data("redactor")},t.fn.getEditor=function(){return this.data("redactor").$editor},t.fn.getCode=function(){return t.trim(this.data("redactor").getCode())},t.fn.getText=function(){return this.data("redactor").$editor.text()},t.fn.getSelected=function(){return this.data("redactor").getSelectedHtml()},t.fn.setCode=function(t){this.data("redactor").setCode(t)},t.fn.insertHtml=function(t){this.data("redactor").insertHtml(t)},t.fn.destroyEditor=function(){this.each(function(){"undefined"!=typeof t(this).data("redactor")&&(t(this).data("redactor").destroy(),t(this).removeData("redactor"))})},t.fn.setFocus=function(){this.data("redactor").$editor.focus()},t.fn.execCommand=function(t,e){this.data("redactor").execCommand(t,e)}}(jQuery),function(t){"use strict";function e(e,i){this.opts=t.extend({url:!1,success:!1,error:!1,preview:!1,uploadFields:!1,text:RLANG.drop_file_here,atext:RLANG.or_choose},i),this.$el=t(e)}t.fn.dragupload=function(t){return this.each(function(){var i=new e(this,t);i.init()})},e.prototype={init:function(){if(-1===navigator.userAgent.search("MSIE")){this.droparea=t('<div class="redactor_droparea"></div>'),this.dropareabox=t('<div class="redactor_dropareabox">'+this.opts.text+"</div>"),this.dropalternative=t('<div class="redactor_dropalternative">'+this.opts.atext+"</div>"),this.droparea.append(this.dropareabox),this.$el.before(this.droparea),this.$el.before(this.dropalternative),this.dropareabox.bind("dragover",t.proxy(function(){return this.ondrag()},this)),this.dropareabox.bind("dragleave",t.proxy(function(){return this.ondragleave()},this));var e=t.proxy(function(t){var e=parseInt(t.loaded/t.total*100,10);this.dropareabox.text("Loading "+e+"%")},this),i=jQuery.ajaxSettings.xhr();i.upload&&i.upload.addEventListener("progress",e,!1);var o=function(){return i};this.dropareabox.get(0).ondrop=t.proxy(function(e){e.preventDefault(),this.dropareabox.removeClass("hover").addClass("drop");var i=e.dataTransfer.files[0],n=new FormData;this.opts.uploadFields!==!1&&"object"==typeof this.opts.uploadFields&&t.each(this.opts.uploadFields,t.proxy(function(e,i){0===i.toString().indexOf("#")&&(i=t(i).val()),n.append(e,i)},this)),n.append("file",i),t.ajax({url:this.opts.url,dataType:"html",data:n,xhr:o,cache:!1,contentType:!1,processData:!1,type:"POST",success:t.proxy(function(e){var i=t.parseJSON(e);"undefined"==typeof i.error?this.opts.success(i):(this.opts.error(this,i),this.opts.success(!1))},this)})},this)}},ondrag:function(){return this.dropareabox.addClass("hover"),!1},ondragleave:function(){return this.dropareabox.removeClass("hover"),!1}}}(jQuery),function(t){"use strict";var e="http://",i=/(^|&lt;|\s)(www\..+?\..+?)(\s|&gt;|$)/g,o=/(^|&lt;|\s)(((https?|ftp):\/\/|mailto:).+?)(\s|&gt;|$)/g,n=function(){for(var s=this.childNodes,a=s.length;a--;){var r=s[a];if(3===r.nodeType){var l=r.nodeValue;l&&(l=l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(i,'$1<a href="'+e+'$2">$2</a>$3').replace(o,'$1<a href="$2">$2</a>$5'),t(r).after(l).remove())}else 1!==r.nodeType||/^(a|button|textarea)$/i.test(r.tagName)||n.call(r)}};t.fn.linkify=function(){this.each(n)}}(jQuery),eval(function(t,e,i,o,n,s){if(n=function(t){return(e>t?"":n(parseInt(t/e)))+((t%=e)>35?String.fromCharCode(t+29):t.toString(36))},!"".replace(/^/,String)){for(;i--;)s[n(i)]=o[i]||n(i);o=[function(t){return s[t]}],n=function(){return"\\w+"},i=1}for(;i--;)o[i]&&(t=t.replace(new RegExp("\\b"+n(i)+"\\b","g"),o[i]));return t}('(5($){$.1.4.7={t:5(0,v){$(2).0("8",c);$(2).0("r",0);$(2).l(\'g\',$.1.4.7.b)},u:5(0){$(2).w(\'g\',$.1.4.7.b)},b:5(1){9 0=$(2).0("r");9 3=$.1.4.7.f(0).h();6(3!=\'\'){$(2).0("8",x);1.j="7";1.3=3;$.1.i.m(2,k)}},f:5(0){9 3=\'\';6(q.e){3=q.e()}o 6(d.e){3=d.e()}o 6(d.p){3=d.p.B().3}A 3}};$.1.4.a={t:5(0,v){$(2).0("n",0);$(2).0("8",c);$(2).l(\'g\',$.1.4.a.b);$(2).l(\'D\',$.1.4.a.s)},u:5(0){$(2).w(\'g\',$.1.4.a.b)},b:5(1){6($(2).0("8")){9 0=$(2).0("n");9 3=$.1.4.7.f(0).h();6(3==\'\'){$(2).0("8",c);1.j="a";$.1.i.m(2,k)}}},s:5(1){6($(2).0("8")){9 0=$(2).0("n");9 3=$.1.4.7.f(0).h();6((1.y=z)&&(3==\'\')){$(2).0("8",c);1.j="a";$.1.i.m(2,k)}}}}})(C);',40,40,"data|event|this|text|special|function|if|textselect|textselected|var|textunselect|handler|false|rdocument|getSelection|getSelectedText|mouseup|toString|handle|type|arguments|bind|apply|rttt|else|selection|rwindow|ttt|handlerKey|setup|teardown|namespaces|unbind|true|keyCode|27|return|createRange|jQuery|keyup".split("|"),0,{})),function(){!function(t,e,i){var o,n,s;return s="slidesjs",n={width:940,height:528,start:1,navigation:{active:!0,effect:"slide"},pagination:{active:!0,effect:"slide"},play:{active:!1,effect:"slide",interval:5e3,auto:!1,swap:!0,pauseOnHover:!1,restartDelay:2500},effect:{slide:{speed:500},fade:{speed:300,crossfade:!0}},callback:{loaded:function(){},start:function(){},complete:function(){}}},o=function(){function e(e,i){this.element=e,this.options=t.extend(!0,{},n,i),this._defaults=n,this._name=s,this.init()}return e}(),o.prototype.init=function(){var i,o,n,s,a,r,l=this;return i=t(this.element),this.data=t.data(this),t.data(this,"animating",!1),t.data(this,"total",i.children().not(".slidesjs-navigation",i).length),t.data(this,"current",this.options.start-1),t.data(this,"vendorPrefix",this._getVendorPrefix()),"undefined"!=typeof TouchEvent&&(t.data(this,"touch",!0),this.options.effect.slide.speed=this.options.effect.slide.speed/2),i.css({overflow:"hidden"}),i.slidesContainer=i.children().not(".slidesjs-navigation",i).wrapAll("<div class='slidesjs-container'>",i).parent().css({overflow:"hidden",position:"relative"}),t(".slidesjs-container",i).wrapInner("<div class='slidesjs-control'>",i).children(),t(".slidesjs-control",i).css({position:"relative",left:0}),t(".slidesjs-control",i).children().addClass("slidesjs-slide").css({position:"absolute",top:0,left:0,width:"100%",zIndex:0,display:"none",webkitBackfaceVisibility:"hidden"}),t.each(t(".slidesjs-control",i).children(),function(e){var i;return i=t(this),i.attr("slidesjs-index",e)}),this.data.touch&&(t(".slidesjs-control",i).on("touchstart",function(t){return l._touchstart(t)}),t(".slidesjs-control",i).on("touchmove",function(t){return l._touchmove(t)}),t(".slidesjs-control",i).on("touchend",function(t){return l._touchend(t)})),i.fadeIn(0),this.update(),this.data.touch&&this._setuptouch(),t(".slidesjs-control",i).children(":eq("+this.data.current+")").eq(0).fadeIn(0,function(){return t(this).css({zIndex:10})}),this.options.navigation.active&&(a=t("<a>",{"class":"slidesjs-previous slidesjs-navigation",href:"#",title:"Previous",text:"Previous"}).appendTo(i),o=t("<a>",{"class":"slidesjs-next slidesjs-navigation",href:"#",title:"Next",text:"Next"}).appendTo(i)),t(".slidesjs-next",i).click(function(t){return t.preventDefault(),l.stop(!0),l.next(l.options.navigation.effect)}),t(".slidesjs-previous",i).click(function(t){return t.preventDefault(),l.stop(!0),l.previous(l.options.navigation.effect)}),this.options.play.active&&(s=t("<a>",{"class":"slidesjs-play slidesjs-navigation",href:"#",title:"Play",text:"Play"}).appendTo(i),r=t("<a>",{"class":"slidesjs-stop slidesjs-navigation",href:"#",title:"Stop",text:"Stop"}).appendTo(i),s.click(function(t){return t.preventDefault(),l.play(!0)}),r.click(function(t){return t.preventDefault(),l.stop(!0)}),this.options.play.swap&&r.css({display:"none"})),this.options.pagination.active&&(n=t("<ul>",{"class":"slidesjs-pagination"}).appendTo(i),t.each(new Array(this.data.total),function(e){var i,o;return i=t("<li>",{"class":"slidesjs-pagination-item"}).appendTo(n),o=t("<a>",{href:"#","data-slidesjs-item":e,html:e+1}).appendTo(i),o.click(function(e){return e.preventDefault(),l.stop(!0),l.goto(1*t(e.currentTarget).attr("data-slidesjs-item")+1)})})),t(e).bind("resize",function(){return l.update()}),this._setActive(),this.options.play.auto&&this.play(),this.options.callback.loaded(this.options.start)},o.prototype._setActive=function(e){var i,o;return i=t(this.element),this.data=t.data(this),o=e>-1?e:this.data.current,t(".active",i).removeClass("active"),t(".slidesjs-pagination li:eq("+o+") a",i).addClass("active")},o.prototype.update=function(){var e,i,o;return e=t(this.element),this.data=t.data(this),t(".slidesjs-control",e).children(":not(:eq("+this.data.current+"))").css({display:"none",left:0,zIndex:0}),o=e.width(),i=this.options.height/this.options.width*o,this.options.width=o,this.options.height=i,t(".slidesjs-control, .slidesjs-container",e).css({width:o,height:i})},o.prototype.next=function(e){var i;return i=t(this.element),this.data=t.data(this),t.data(this,"direction","next"),void 0===e&&(e=this.options.navigation.effect),"fade"===e?this._fade():this._slide()},o.prototype.previous=function(e){var i;return i=t(this.element),this.data=t.data(this),t.data(this,"direction","previous"),void 0===e&&(e=this.options.navigation.effect),"fade"===e?this._fade():this._slide()},o.prototype.goto=function(e){var i,o;if(i=t(this.element),this.data=t.data(this),void 0===o&&(o=this.options.pagination.effect),e>this.data.total?e=this.data.total:1>e&&(e=1),"number"==typeof e)return"fade"===o?this._fade(e):this._slide(e);if("string"==typeof e){if("first"===e)return"fade"===o?this._fade(0):this._slide(0);if("last"===e)return"fade"===o?this._fade(this.data.total):this._slide(this.data.total)}},o.prototype._setuptouch=function(){var e,i,o,n;return e=t(this.element),this.data=t.data(this),n=t(".slidesjs-control",e),i=this.data.current+1,o=this.data.current-1,0>o&&(o=this.data.total-1),i>this.data.total-1&&(i=0),n.children(":eq("+i+")").css({display:"block",left:this.options.width}),n.children(":eq("+o+")").css({display:"block",left:-this.options.width})},o.prototype._touchstart=function(e){var i,o;return i=t(this.element),this.data=t.data(this),o=e.originalEvent.touches[0],this._setuptouch(),t.data(this,"touchtimer",Number(new Date)),t.data(this,"touchstartx",o.pageX),t.data(this,"touchstarty",o.pageY),e.stopPropagation()},o.prototype._touchend=function(e){var i,o,n,s,a,r,l,d=this;return i=t(this.element),this.data=t.data(this),r=e.originalEvent.touches[0],s=t(".slidesjs-control",i),s.position().left>.5*this.options.width||s.position().left>.1*this.options.width&&Number(new Date)-this.data.touchtimer<250?(t.data(this,"direction","previous"),this._slide()):s.position().left<-(.5*this.options.width)||s.position().left<-(.1*this.options.width)&&Number(new Date)-this.data.touchtimer<250?(t.data(this,"direction","next"),this._slide()):(n=this.data.vendorPrefix,l=n+"Transform",o=n+"TransitionDuration",a=n+"TransitionTimingFunction",s[0].style[l]="translateX(0px)",s[0].style[o]=.85*this.options.effect.slide.speed+"ms"),s.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){return n=d.data.vendorPrefix,l=n+"Transform",o=n+"TransitionDuration",a=n+"TransitionTimingFunction",s[0].style[l]="",s[0].style[o]="",s[0].style[a]=""}),e.stopPropagation()},o.prototype._touchmove=function(e){var i,o,n,s,a;return i=t(this.element),this.data=t.data(this),s=e.originalEvent.touches[0],o=this.data.vendorPrefix,n=t(".slidesjs-control",i),a=o+"Transform",t.data(this,"scrolling",Math.abs(s.pageX-this.data.touchstartx)<Math.abs(s.pageY-this.data.touchstarty)),this.data.animating||this.data.scrolling||(e.preventDefault(),this._setuptouch(),n[0].style[a]="translateX("+(s.pageX-this.data.touchstartx)+"px)"),e.stopPropagation()},o.prototype.play=function(e){var i,o,n,s=this;return i=t(this.element),this.data=t.data(this),!this.data.playInterval&&(e&&(o=this.data.current,this.data.direction="next","fade"===this.options.play.effect?this._fade():this._slide()),t.data(this,"playInterval",setInterval(function(){return o=s.data.current,s.data.direction="next","fade"===s.options.play.effect?s._fade():s._slide()},this.options.play.interval)),n=t(".slidesjs-container",i),this.options.play.pauseOnHover&&(n.unbind(),n.bind("mouseenter",function(){return s.stop()}),n.bind("mouseleave",function(){return s.options.play.restartDelay?t.data(s,"restartDelay",setTimeout(function(){return s.play(!0)},s.options.play.restartDelay)):s.play()})),t.data(this,"playing",!0),t(".slidesjs-play",i).addClass("slidesjs-playing"),this.options.play.swap)?(t(".slidesjs-play",i).hide(),t(".slidesjs-stop",i).show()):void 0},o.prototype.stop=function(e){var i;return i=t(this.element),this.data=t.data(this),clearInterval(this.data.playInterval),this.options.play.pauseOnHover&&e&&t(".slidesjs-container",i).unbind(),t.data(this,"playInterval",null),t.data(this,"playing",!1),t(".slidesjs-play",i).removeClass("slidesjs-playing"),this.options.play.swap?(t(".slidesjs-stop",i).hide(),t(".slidesjs-play",i).show()):void 0},o.prototype._slide=function(e){var i,o,n,s,a,r,l,d,c,h,u=this;return i=t(this.element),this.data=t.data(this),this.data.animating||e===this.data.current+1?void 0:(t.data(this,"animating",!0),o=this.data.current,e>-1?(e-=1,h=e>o?1:-1,n=e>o?-this.options.width:this.options.width,a=e):(h="next"===this.data.direction?1:-1,n="next"===this.data.direction?-this.options.width:this.options.width,a=o+h),-1===a&&(a=this.data.total-1),a===this.data.total&&(a=0),this._setActive(a),l=t(".slidesjs-control",i),e>-1&&l.children(":not(:eq("+o+"))").css({display:"none",left:0,zIndex:0}),l.children(":eq("+a+")").css({display:"block",left:h*this.options.width,zIndex:10}),this.options.callback.start(o+1),this.data.vendorPrefix?(r=this.data.vendorPrefix,c=r+"Transform",s=r+"TransitionDuration",d=r+"TransitionTimingFunction",l[0].style[c]="translateX("+n+"px)",l[0].style[s]=this.options.effect.slide.speed+"ms",l.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){return l[0].style[c]="",l[0].style[s]="",l.children(":eq("+a+")").css({left:0}),l.children(":eq("+o+")").css({display:"none",left:0,zIndex:0}),t.data(u,"current",a),t.data(u,"animating",!1),l.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd"),l.children(":not(:eq("+a+"))").css({display:"none",left:0,zIndex:0}),u.data.touch&&u._setuptouch(),u.options.callback.complete(a+1)})):l.stop().animate({left:n},this.options.effect.slide.speed,function(){return l.css({left:0}),l.children(":eq("+a+")").css({left:0}),l.children(":eq("+o+")").css({display:"none",left:0,zIndex:0},t.data(u,"current",a),t.data(u,"animating",!1),u.options.callback.complete(a+1))}))},o.prototype._fade=function(e){var i,o,n,s,a,r=this;return i=t(this.element),this.data=t.data(this),this.data.animating||e===this.data.current+1?void 0:(t.data(this,"animating",!0),o=this.data.current,e?(e-=1,a=e>o?1:-1,n=e):(a="next"===this.data.direction?1:-1,n=o+a),-1===n&&(n=this.data.total-1),n===this.data.total&&(n=0),this._setActive(n),s=t(".slidesjs-control",i),s.children(":eq("+n+")").css({display:"none",left:0,zIndex:10}),this.options.callback.start(o+1),this.options.effect.fade.crossfade?(s.children(":eq("+this.data.current+")").stop().fadeOut(this.options.effect.fade.speed),s.children(":eq("+n+")").stop().fadeIn(this.options.effect.fade.speed,function(){return s.children(":eq("+n+")").css({zIndex:0}),t.data(r,"animating",!1),t.data(r,"current",n),r.options.callback.complete(n+1)})):s.children(":eq("+o+")").stop().fadeOut(this.options.effect.fade.speed,function(){return s.children(":eq("+n+")").stop().fadeIn(r.options.effect.fade.speed,function(){return s.children(":eq("+n+")").css({zIndex:10})}),t.data(r,"animating",!1),t.data(r,"current",n),r.options.callback.complete(n+1)}))},o.prototype._getVendorPrefix=function(){var t,e,o,n,s;for(t=i.body||i.documentElement,o=t.style,n="transition",s=["Moz","Webkit","Khtml","O","ms"],n=n.charAt(0).toUpperCase()+n.substr(1),e=0;e<s.length;){if("string"==typeof o[s[e]+n])return s[e];e++}return!1},t.fn[s]=function(e){return this.each(function(){return t.data(this,"plugin_"+s)?void 0:t.data(this,"plugin_"+s,new o(this,e))})}}(jQuery,window,document)}.call(this),$(function(){$(".axform").submit(function(t){submitAjax($(this)),t.preventDefault()}),$(".file-form").submit(function(t){t.preventDefault(),$(this).children("button").innerHTML="Uploading..."
}),$("#request-training").submit(function(t){t.preventDefault();var e=new Date,i=e.getMonth(),o=e.getDate(),n=e.getFullYear(),s=e.getHours(),a=e.getMinutes(),r=$(".datepick:eq(0)").val();""==r&&(r=n+"-"+i+"-"+o+" "+s+":"+a+":00");var l=$(".datepick:eq(1)").val();""==l&&(l=n+"-"+i+"-"+o+" "+s+":"+a+":00"),$.ajax({url:"/t/request/new",type:"post",data:{start:r,end:l,user:document.getElementById("userid").value,cert:document.getElementById("examid").value}}).done(function(t){t=JSON.parse(t),$("#flash").prepend(t.success?t.message:t.message)})}),$("#pm-reply").submit(function(t){validateCC($(this))||t.preventDefault()})}),$(function(){if(highlightCorrect(),$(".datepick").datetimepicker({language:"en",inline:!0,minDate:"0",maxDate:"+1970/01/30",onChangeDateTime:function(t,e){var i=$(this.prev()[0]).data("field");document.getElementById(i).value=e.val()}}),$("#slideshow").slidesjs({width:900,height:400,pagination:{active:!1},play:{active:!1,interval:4e3,auto:!0,swap:!1,pauseOnHover:!0,restartDelay:2500},effect:{slide:{speed:2e3},fade:{speed:2e3,crossfade:!0}}}),$("#training")){var t=$("#training .progress-bar").attr("aria-valuenow"),e=t/58*100;$("#training .progress-bar").css("width",e+"%")}$(".editor").redactor({buttons:["bold","italic","underline","unorderedlist","orderedlist","outdent","indent","image","link"]})});